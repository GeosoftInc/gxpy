

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>geosoft.gxpy.gx &#8212; Geosoft GX Python API 9.10.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/maki.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-87443115-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Geosoft GX Python API 9.10.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geosoft.gxpy.gx</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Introduction</a></li>
    <li><a href="../../index.html">Module code</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geosoft.gxpy.gx</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GX Context and related methods required for Geosoft Python.</span>

<span class="sd">:Classes:</span>
<span class="sd">    :`GXpy`: the Geosoft GX context</span>

<span class="sd">The GX context is a singleton, which is either created for</span>
<span class="sd">stand-alone Python scripts, or is provided to the script for extensions to Geosoft Desktop applications.</span>

<span class="sd">.. note::</span>

<span class="sd">    Regression tests provide usage examples:</span>
<span class="sd">    `gx tests &lt;https://github.com/GeosoftInc/gxpy/blob/master/geosoft/gxpy/tests/test_gx.py&gt;`_</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">tkinter.ttk</span> <span class="k">as</span> <span class="nn">ttk</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">atexit</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="kn">import</span> <span class="nn">geosoft</span>
<span class="kn">import</span> <span class="nn">geosoft.gxapi</span> <span class="k">as</span> <span class="nn">gxapi</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utility</span> <span class="k">as</span> <span class="n">gxu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">system</span> <span class="k">as</span> <span class="n">gxs</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">__version__</span>


<span class="k">def</span> <span class="nf">_t</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">gxpy</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<div class="viewcode-block" id="GXException"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXException">[docs]</a><span class="k">class</span> <span class="nc">GXException</span><span class="p">(</span><span class="n">geosoft</span><span class="o">.</span><span class="n">GXRuntimeError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exceptions from :mod:`geosoft.gxpy.gx`.</span>

<span class="sd">    .. versionadded:: 9.1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="n">_singleton_getattr_default</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="n">_is_sphinx_build</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GEOSOFT_SPHINX_BUILD&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span>
<span class="n">_tls</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">local</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">_get_gx_instance</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">GXpyContext</span><span class="o">.</span><span class="n">_get_instance</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_have_gx</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">GXpyContext</span><span class="o">.</span><span class="n">_get_instance</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>


<div class="viewcode-block" id="TLSGlobals"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.TLSGlobals">[docs]</a><span class="k">class</span> <span class="nc">TLSGlobals</span><span class="p">:</span>
    <span class="n">_res_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_res_heap</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">_max_resource_heap</span> <span class="o">=</span> <span class="mi">1000000</span>
    <span class="n">_stack_depth</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">_max_warnings</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">_NULL_ID</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></div>


<span class="k">def</span> <span class="nf">_get_tls_globals</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">_tls</span>
    <span class="n">tls_globals</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_tls</span><span class="p">,</span> <span class="s1">&#39;_gxpy_tls_globals&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tls_globals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tls_globals</span>
    <span class="k">if</span> <span class="n">_tls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">_tls</span><span class="o">.</span><span class="n">_gxpy_tls_globals</span> <span class="o">=</span> <span class="n">TLSGlobals</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_tls</span><span class="o">.</span><span class="n">_gxpy_tls_globals</span>


<span class="k">def</span> <span class="nf">_reset_tls_globals</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">_tls</span>
    <span class="c1"># Reset singlton wrappers</span>
    <span class="n">_tls</span><span class="o">.</span><span class="n">_gxpy_tls_globals</span> <span class="o">=</span> <span class="kc">None</span>


<div class="viewcode-block" id="track_resource"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.track_resource">[docs]</a><span class="k">def</span> <span class="nf">track_resource</span><span class="p">(</span><span class="n">resource_class</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Track a resource.  Resource tracking is useful for debugging resource leaks.  If you create a class</span>
<span class="sd">    or resource that you expect to be removed before your script ends you can track it with this call.</span>
<span class="sd">    When you dispose of your resource call :meth:`pop_resource` to remove it from the tracking heap.</span>
<span class="sd">    On exit, any resource left on the tracked resource heap will be reported together with the call</span>
<span class="sd">    stack for each resource and the information you provided.</span>

<span class="sd">    :param resource_class: the resource class name</span>
<span class="sd">    :param info: some information about the resource</span>
<span class="sd">    :returns: resource_id, can be used with :meth:`pop_resource`</span>

<span class="sd">    .. versionadded:: 9.2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tls_globals</span> <span class="o">=</span> <span class="n">_get_tls_globals</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_id</span> <span class="o">&lt;</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_max_resource_heap</span><span class="p">:</span>
        <span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource_class</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tls_globals</span><span class="o">.</span><span class="n">_stack_depth</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">gxs</span><span class="o">.</span><span class="n">func_name</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">rs</span> <span class="o">+=</span> <span class="s1">&#39;&lt;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gxs</span><span class="o">.</span><span class="n">func_name</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">rs</span> <span class="o">+=</span> <span class="s1">&#39; [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_heap</span><span class="p">[</span><span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs</span>
        <span class="k">return</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_id</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_NULL_ID</span></div>


<div class="viewcode-block" id="pop_resource"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.pop_resource">[docs]</a><span class="k">def</span> <span class="nf">pop_resource</span><span class="p">(</span><span class="n">res_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pop a tracked resource off the resource stack.</span>

<span class="sd">    :param res_id:  the resource id returned by :meth:`track_resource`</span>

<span class="sd">    .. versionadded:: 9.2</span>

<span class="sd">    .. versionchanged:: 9.3.1</span>
<span class="sd">        changed id to res_id to avoid built-in shadow</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tls_globals</span> <span class="o">=</span> <span class="n">_get_tls_globals</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">res_id</span> <span class="o">!=</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_NULL_ID</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_heap</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">del</span> <span class="p">(</span><span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_heap</span><span class="p">[</span><span class="n">res_id</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span></div>


<span class="k">def</span> <span class="nf">_log_file_error</span><span class="p">(</span><span class="n">fnc</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">excinfo</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">_have_gx</span><span class="p">():</span>
        <span class="n">gx</span> <span class="o">=</span> <span class="n">_get_gx_instance</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
            <span class="n">gx</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s2">&quot;error removing temporary file</span><span class="se">\n</span><span class="s2">   </span><span class="se">\&quot;</span><span class="si">{}</span><span class="se">\&quot;\n</span><span class="s2">function </span><span class="se">\&quot;</span><span class="si">{}</span><span class="se">\&quot;\n</span><span class="s2">exception</span><span class="se">\&quot;</span><span class="si">{}</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fnc</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">excinfo</span><span class="p">)))</span>


<div class="viewcode-block" id="gx"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.gx">[docs]</a><span class="k">def</span> <span class="nf">gx</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Returns the current thread `GXpy` instance.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_gx</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXAPIError</span><span class="p">(</span><span class="s2">&quot;A GXpy instance has not been created for current thread yet, &quot;</span>
                               <span class="s2">&quot;or the original context has been released.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_get_gx_instance</span><span class="p">()</span></div>

<div class="viewcode-block" id="GXpy"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpy">[docs]</a><span class="k">def</span> <span class="nf">GXpy</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span> <span class="n">parent_window</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_res_heap</span><span class="o">=</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">res_stack</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
         <span class="n">max_warnings</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">suppress_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;Core&#39;</span><span class="p">,</span> <span class="n">per_user_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">redist_override</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">redist_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temp_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiate a Geosoft GX context.  There should be only one instance of this created per thread.</span>
<span class="sd">        To simplify usage, use this method to instantiaate the context and the :func:`.gxpy.gx.gx` methods instead</span>
<span class="sd">        to obtain the current thread instance.</span>

<span class="sd">        It is a good idea to use the with statement pattern to ensure timely cleanup of unmanaged resources.</span>

<span class="sd">        :parameters:</span>
<span class="sd">            :name:              application name, default is the script name</span>
<span class="sd">            :version:           application version number, default Geosoft version</span>
<span class="sd">            :parent_window:     ID of the parent window.  A parent window is required for GUI-dependent</span>
<span class="sd">                                functions to work.  Set `parent_window=-1` to create a Tkinter frame that</span>
<span class="sd">                                provides a default parent window handle for GUI/Viewer functions.</span>
<span class="sd">            :log:               name of a file to record logging information, or a call-back function that</span>
<span class="sd">                                accepts a string.  Specifying `log=&#39;&#39;` will log to a default file named</span>
<span class="sd">                                using the current date and time.  If not provided calls to log()</span>
<span class="sd">                                are ignored.</span>
<span class="sd">            :max_res_heap:      If logging is on, open gxpy resources (like grids, or databases) are tracked.</span>
<span class="sd">                                This is the maximum size of resource heap for tracking open resources.</span>
<span class="sd">                                Set to 0 to not track resources. On exit, if any resources remain open</span>
<span class="sd">                                a warning is logged together with a list of the open resources, each with a</span>
<span class="sd">                                call stack to help find the function that created the resources.</span>
<span class="sd">            :res_stack:         Depth of the call-stack to report for open-resource warning.</span>
<span class="sd">            :max_warnings:      Maximum number of resource warnings to report.</span>
<span class="sd">            :suppress_progress: True to suppress progress reporting (default False)</span>
<span class="sd">            :key:               Default Geosoft registry key to use (in absence of geosoft.key file) to discover</span>
<span class="sd">                                GX developer common redistributables or Desktop Applications software (default &#39;Core&#39;)</span>
<span class="sd">            :per_user_key:      Use per-user registry instead of local machine (default False)</span>
<span class="sd">            :redist_override:   Override registry mechanism to discover redistributables with redist_dir,</span>
<span class="sd">                                user_dir and temp_dir parameters. (default False)</span>
<span class="sd">            :redist_dir:        Path containing the redistributable files, i.e. containing bin, csv and other folders.</span>
<span class="sd">                                Only used if redist_override is True (default None)</span>
<span class="sd">            :user_dir:          Writable path to directory containing the user redistributable files.</span>
<span class="sd">                                Only used if redist_override is True (default None). If redist_override is True and</span>
<span class="sd">                                user_dir is None a unique folder in system temp will be used for this purpose.</span>
<span class="sd">            :temp_dir:          Path to use for temporary files. Only used if redist_override is True (default None)</span>
<span class="sd">                                If redist_override is True and temp_dir is None a unique folder in system temp will</span>
<span class="sd">                                be used for this purpose.</span>

<span class="sd">    .. seealso::</span>

<span class="sd">        Class :class:`.gxpy.gx.GXpyContext`</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">GXpyContext</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">parent_window</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">max_res_heap</span><span class="p">,</span> <span class="n">res_stack</span><span class="p">,</span> <span class="n">max_warnings</span><span class="p">,</span> <span class="n">suppress_progress</span><span class="p">,</span>
                       <span class="n">key</span><span class="p">,</span> <span class="n">per_user_key</span><span class="p">,</span> <span class="n">redist_override</span><span class="p">,</span> <span class="n">redist_dir</span><span class="p">,</span> <span class="n">user_dir</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">)</span></div>


<div class="viewcode-block" id="GXpyContext"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext">[docs]</a><span class="k">class</span> <span class="nc">GXpyContext</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Geosoft GX context.  There should be only one instance of this created per thread. To simplify usage, use the</span>
<span class="sd">    :func:`.gxpy.gx.GXpy` and :func:`.gxpy.gx.gx` methods instead of instantiating this class directly.</span>

<span class="sd">    This class does not need to be instantiated by the main thread in Oasis montaj desktop extension scripts,</span>
<span class="sd">    since the context is instantiated prior to entering the rungx method. If called, the desktop context is returned.</span>

<span class="sd">    It is a good idea to use the with statement pattern to ensure timely cleanup of unmanaged resources.</span>

<span class="sd">    :parameters:</span>
<span class="sd">        :name:              application name, default is the script name</span>
<span class="sd">        :version:           application version number, default Geosoft version</span>
<span class="sd">        :parent_window:     ID of the parent window.  A parent window is required for GUI-dependent</span>
<span class="sd">                            functions to work.  Set `parent_window=-1` to create a Tkinter frame that</span>
<span class="sd">                            provides a default parent window handle for GUI/Viewer functions.</span>
<span class="sd">        :log:               name of a file to record logging information, or a call-back function that</span>
<span class="sd">                            accepts a string.  Specifying `log=&#39;&#39;` will log to a default file named</span>
<span class="sd">                            using the current date and time.  If not provided calls to log()</span>
<span class="sd">                            are ignored.</span>
<span class="sd">        :max_res_heap:      If logging is on, open gxpy resources (like grids, or databases) are tracked.</span>
<span class="sd">                            This is the maximum size of resource heap for tracking open resources.</span>
<span class="sd">                            Set to 0 to not track resources. On exit, if any resources remain open</span>
<span class="sd">                            a warning is logged together with a list of the open resources, each with a</span>
<span class="sd">                            call stack to help find the function that created the resources.</span>
<span class="sd">        :res_stack:         Depth of the call-stack to report for open-resource warning.</span>
<span class="sd">        :max_warnings:      Maximum number of resource warnings to report.</span>
<span class="sd">        :suppress_progress: True to suppress progress reporting (default False)</span>
<span class="sd">        :key:               Default Geosoft registry key to use (in absence of geosoft.key file) to discover</span>
<span class="sd">                            GX developer common redistributables or Desktop Applications software (default &#39;Core&#39;)</span>
<span class="sd">        :per_user_key:      Use per-user registry instead of local machine (default False)</span>
<span class="sd">        :redist_override:   Override registry mechanism to discover redistributables with redist_dir,</span>
<span class="sd">                            user_dir and temp_dir parameters. (default False)</span>
<span class="sd">        :redist_dir:        Path containing the redistributable files, i.e. containing bin, csv and other folders.</span>
<span class="sd">                            Only used if redist_override is True (default None)</span>
<span class="sd">        :user_dir:          Writable path to directory containing the user redistributable files.</span>
<span class="sd">                            Only used if redist_override is True (default None). If redist_override is True and</span>
<span class="sd">                            user_dir is None a unique folder in system temp will be used for this purpose.</span>
<span class="sd">        :temp_dir:          Path to use for temporary files. Only used if redist_override is True (default None)</span>
<span class="sd">                            If redist_override is True and temp_dir is None a unique folder in system temp will</span>
<span class="sd">                            be used for this purpose.</span>

<span class="sd">    :Properties:</span>
<span class="sd">        :gxapi:             GX context to be used to call geosoft.gxapi methods</span>
<span class="sd">        :tkframe:           tkframe for UI applications.  Will be None if a the context was created from a window</span>
<span class="sd">                            application.</span>
<span class="sd">        :gid:               User&#39;s Geosoft ID</span>
<span class="sd">        :current_date:      date at start-up</span>
<span class="sd">        :current_utc_date:  UTC date at start-up</span>
<span class="sd">        :current_time:      time at start-up</span>
<span class="sd">        :current_utc_time:  UTC time at start-up</span>
<span class="sd">        :folder_workspace:  Geosoft workspace folder</span>
<span class="sd">        :folder_temp:       Geosoft temporary folder</span>
<span class="sd">        :folder_user:       Geosoft Desktop installation &#39;user&#39; folder</span>

<span class="sd">    :raises:</span>
<span class="sd">        :GXException(): if unable to create context</span>

<span class="sd">    .. versionadded:: 9.1</span>

<span class="sd">    .. versionchanged:: 9.2</span>

<span class="sd">        | * `parent_window=-1` creates a Tkinter frame as a parent for scripts that call UI functions.</span>
<span class="sd">        | * Added `log` argument to support `log()`.</span>
<span class="sd">        | * Made environment dictionary properties, deprecated environment.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;GID: </span><span class="si">{}</span><span class="s2">, class: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">license_class</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_type</span><span class="p">,</span> <span class="n">_value</span><span class="p">,</span> <span class="n">_traceback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__del__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">()</span>

    <span class="n">_gxpy_deleted</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_gxpy_deleted&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxpy_deleted</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">tls_globals</span> <span class="o">=</span> <span class="n">_get_tls_globals</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">tls_globals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">GX closing&#39;</span><span class="p">)</span>

            <span class="n">temp_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">temp_folder</span> <span class="ow">and</span> <span class="p">(</span><span class="n">temp_folder</span> <span class="o">!=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_temp</span><span class="p">()):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">onerror</span><span class="o">=</span><span class="n">_log_file_error</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_heap</span><span class="p">):</span>
                <span class="c1"># resources were created but not deleted or removed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Warning - cleaning up resources that are still open:&#39;</span><span class="p">))</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_heap</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">tls_globals</span><span class="o">.</span><span class="n">_max_warnings</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;    and there are </span><span class="si">{}</span><span class="s1"> more (change GXpy(max_warnings=) to see more)...&#39;</span>
                                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tls_globals</span><span class="o">.</span><span class="n">_res_heap</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span><span class="p">)))</span>
                        <span class="k">break</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close_log</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clean_redist_folders</span><span class="p">()</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkframe</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span><span class="o">.</span><span class="fm">__del__</span><span class="p">()</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span>
            <span class="n">GXpyContext</span><span class="o">.</span><span class="n">_set_instance</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="GXpyContext.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span>
                 <span class="n">parent_window</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">max_res_heap</span><span class="o">=</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">res_stack</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">max_warnings</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">suppress_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;Core&#39;</span><span class="p">,</span> <span class="n">per_user_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">redist_override</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">redist_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temp_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">_have_gx</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXAPIError</span><span class="p">(</span><span class="s2">&quot;A GXpy instance has already been created for current thread.&quot;</span><span class="p">)</span>

        <span class="n">tls_globals</span> <span class="o">=</span> <span class="n">_get_tls_globals</span><span class="p">()</span>

        <span class="c1"># Reset testing UUID base with every init</span>
        <span class="n">gxu</span><span class="o">.</span><span class="n">d_uuid_count</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">log</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tls_globals</span><span class="o">.</span><span class="n">_max_resource_heap</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tls_globals</span><span class="o">.</span><span class="n">_max_resource_heap</span> <span class="o">=</span> <span class="n">max_res_heap</span>
            <span class="n">tls_globals</span><span class="o">.</span><span class="n">_stack_depth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">res_stack</span><span class="p">)</span>
            <span class="n">tls_globals</span><span class="o">.</span><span class="n">_max_warnings</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_warnings</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_enter_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redist_dir</span> <span class="o">=</span> <span class="n">redist_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir</span> <span class="o">=</span> <span class="n">user_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir_cleanup</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir</span> <span class="o">=</span> <span class="n">temp_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir_cleanup</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># create a Tkinter parent frame for the viewers</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent_window</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">pythoncom</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span>
                    <span class="s1">&#39;Unable to import the pythoncom module, which is needed for GUI APIs to work.&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tkframe</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">parent_window</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkframe</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">parent_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkframe</span><span class="o">.</span><span class="n">winfo_id</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_window</span> <span class="o">=</span> <span class="n">parent_window</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">suppress_progress</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_window</span><span class="p">:</span>
                    <span class="n">flags</span> <span class="o">=</span> <span class="mi">128</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">flags</span> <span class="o">=</span> <span class="mi">64</span>

            <span class="k">if</span> <span class="n">redist_override</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redist_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">GXException</span><span class="p">(</span><span class="s1">&#39;redist_dir needs to be defined with redist_override.&#39;</span><span class="p">)</span>
                <span class="n">geodist_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_dir</span><span class="p">,</span> <span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="s1">&#39;geodist.dll&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">geodist_path</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">GXException</span><span class="p">(</span><span class="s1">&#39;redist_dir needs to point to directory containing Geosoft redistributables. &#39;</span>
                                      <span class="s1">&#39;(Could not find </span><span class="si">{}</span><span class="s1">)).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geodist_path</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir_cleanup</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">GXException</span><span class="p">(</span><span class="s1">&#39;temp_dir needs to point an existing directory (or pass None to use &#39;</span> 
                                      <span class="s1">&#39;automatic temporary folder).&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir_cleanup</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">GXException</span><span class="p">(</span><span class="s1">&#39;user_dir needs to point an existing directory (or pass None to use &#39;</span>
                                      <span class="s1">&#39;automatic temporary folder).&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXContext</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_window</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                                                 <span class="n">per_user_key</span><span class="o">=</span><span class="n">per_user_key</span><span class="p">,</span> <span class="n">redist_override</span><span class="o">=</span><span class="n">redist_override</span><span class="p">,</span>
                                                 <span class="n">redist_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_dir</span><span class="p">,</span> <span class="n">user_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir</span><span class="p">,</span>
                                                 <span class="n">temp_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXAPIError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">raise</span> <span class="n">GXException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;GX services are not available.</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">company</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_licensed_user</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">company</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gid</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_folder</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keep_temp_files</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gxid</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">uuid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entitlements</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># general properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_date</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_utc_date</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">utc_date</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_utc_time</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">utc_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_workspace</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_workspace</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_temp</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_temp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_user</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_user</span><span class="p">()</span>

        <span class="c1"># determine license</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># test if we can create a GXST2 instance, which requires a minimal license</span>
            <span class="n">gxapi</span><span class="o">.</span><span class="n">GXST2</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entitled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXAPIError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entitled</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># create a log file</span>
        <span class="k">if</span> <span class="n">log</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logf</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_it</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">log</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log_it</span> <span class="o">=</span> <span class="n">log</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logf</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dts</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">)&quot;</span> \
                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">day</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">second</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">//</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                    <span class="n">log</span> <span class="o">=</span> <span class="s2">&quot;_gx_&quot;</span> <span class="o">+</span> <span class="n">dts</span> <span class="o">+</span> <span class="s2">&quot;.log&quot;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_logf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log_it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_to_file</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;UTC:      </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Script:   </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gxs</span><span class="o">.</span><span class="n">app_name</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;GX API:   </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">__version__</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Core API: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geosoft_version_label</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;BIN_PATH: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GX_GEOSOFT_BIN_PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Project:  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gxu</span><span class="o">.</span><span class="n">folder_workspace</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;GID:      </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gid</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Entitled: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entitled</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">GX open&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gxpy_deleted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">GXpyContext</span><span class="o">.</span><span class="n">_set_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="n">_tls_instance_name</span> <span class="o">=</span> <span class="s1">&#39;_GXpyContext_tls_instance&#39;</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_set_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">_tls</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">_tls</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tls_instance_name</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">_tls</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_tls</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tls_instance_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_log_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">dts</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
                                             <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                             <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">day</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                             <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                             <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                             <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">second</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                                             <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">//</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">log_str</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">log_str</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">logstr</span> <span class="o">=</span> <span class="n">dts</span> <span class="o">+</span> <span class="n">l</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">logstr</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gxapi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gxapi context for calls to geosoft.gxapi&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tkframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;tkframe if created fro this context, None if not created&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkframe</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parent_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;parent window for this context&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_window</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        API version description</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">__version__</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">profile_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft ID profile use name.</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_profile_name</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">profile_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft ID profile url in My Geosoft portal.</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_profile_url</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">main_wind_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The main window ID (HWND cast to unsigned for Windows).</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_window</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span><span class="o">.</span><span class="n">get_main_wnd_id</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_window</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">active_wind_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The active window ID (HWND cast to unsigned for Windows).</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span><span class="o">.</span><span class="n">get_active_wnd_id</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft installed product name</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_PRODUCTNAME</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_build_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft build label.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_BUILD_LABEL</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_build_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft build numberl.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_BUILD_NUMBER</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_version_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft version label.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_VERSION_LABEL</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_version_major</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft major version number.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_VERSION_MAJOR</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_version_minor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft minor version number.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_VERSION_MINOR</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geosoft_version_micro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft micro version number.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_sys_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">SYS_INFO_VERSION_SP</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="GXpyContext.remove_stale_temporary_files"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.remove_stale_temporary_files">[docs]</a>    <span class="k">def</span> <span class="nf">remove_stale_temporary_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes stale temporary files from the current instance temporary file folder.</span>

<span class="sd">        :param age: files older than this age is seconds are removed.  The default is 24 * 60 * 60.</span>

<span class="sd">        Many classes that depend on a persistent file will support the creation of a class instance</span>
<span class="sd">        without providing a specific file name, in which case a temporary file is created in the</span>
<span class="sd">        temporary folder for this running GX instance. Upon loss of GX context all temporary files will</span>
<span class="sd">        be removed, but for a long-running process, such as a GX instnce that supports a web application,</span>
<span class="sd">        it can be useful to use this function to remove stale files and free valuable disk space.</span>

<span class="sd">        Folders, if any, are not removed, but stale-dated files within folders will be removed.</span>

<span class="sd">        .. versionadded:: 9.3.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">remove_all_files</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)):</span>
                <span class="n">ff</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ff</span><span class="p">):</span>
                    <span class="n">remove_all_files</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">gxu</span><span class="o">.</span><span class="n">is_file_locked</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="n">age</span><span class="p">):</span>
                        <span class="n">gxu</span><span class="o">.</span><span class="n">delete_file</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>

        <span class="n">remove_all_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span><span class="p">())</span></div>

<div class="viewcode-block" id="GXpyContext.disable_app"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.disable_app">[docs]</a>    <span class="k">def</span> <span class="nf">disable_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Disables application windows to allow modal Python UI.</span>
<span class="sd">        Call before opening your own UI window.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span><span class="o">.</span><span class="n">enable_application_windows</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="GXpyContext.enable_app"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.enable_app">[docs]</a>    <span class="k">def</span> <span class="nf">enable_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enables application windows to allow modal Python UI.</span>
<span class="sd">        Call before returning control to OM.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gxapi</span><span class="o">.</span><span class="n">enable_application_windows</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="GXpyContext.entitlements"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.entitlements">[docs]</a>    <span class="k">def</span> <span class="nf">entitlements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :returns: The current user entitlements as a dictionary.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entitlements</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXLST</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
            <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_entitlement_rights</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entitlements</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">dict_from_lst</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entitlements</span></div>

<div class="viewcode-block" id="GXpyContext.has_entitlement"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.has_entitlement">[docs]</a>    <span class="k">def</span> <span class="nf">has_entitlement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the user has this entitlement.</span>

<span class="sd">        :param ent: Entitlement number or descriptive name (case sensitive)</span>

<span class="sd">        | Partial list of entitlements as of 9.3 platform (subject to change):</span>
<span class="sd">        |    1000: &quot;Oasis montaj Base&quot;</span>
<span class="sd">        |    10000: &quot;Oasis montaj Mapping and Processing System&quot;</span>
<span class="sd">        |    100010: &quot;Geosoft - Virtual Computer License&quot;</span>
<span class="sd">        |    10100: &quot;Geophysics&quot;</span>
<span class="sd">        |    10101: &quot;Geochemistry&quot;</span>
<span class="sd">        |    10102: &quot;Drillhole Plotting&quot;</span>
<span class="sd">        |    10103: &quot;Induced Polarization&quot;</span>
<span class="sd">        |    10104: &quot;Geophysics Levelling&quot;</span>
<span class="sd">        |    10105: &quot;MAGMAP Filtering&quot;</span>
<span class="sd">        |    10106: &quot;Grav/Mag Interpretation&quot;</span>
<span class="sd">        |    10107: &quot;Airborne Quality Control&quot;</span>
<span class="sd">        |    10108: &quot;256-Channel Radiometric Processing&quot;</span>
<span class="sd">        |    10109: &quot;Gravity and Terrain Correction&quot;</span>
<span class="sd">        |    10110: &quot;GridKnit&quot;</span>
<span class="sd">        |    10111: &quot;UXO Land&quot;</span>
<span class="sd">        |    10114: &quot;UXO Marine&quot;</span>
<span class="sd">        |    10500: &quot;montaj plus Modeling Lite (PotentQ)&quot;</span>
<span class="sd">        |    10520: &quot;GM-SYS Basic Profile Modeling&quot;</span>
<span class="sd">        |    10521: &quot;GM-SYS Intermediate Profile Modeling&quot;</span>
<span class="sd">        |    10522: &quot;GM-SYS Advanced Profile Modeling&quot;</span>
<span class="sd">        |    10523: &quot;GM-SYS 3D Modeling&quot;</span>
<span class="sd">        |    10524: &quot;Depth to Basement&quot;</span>
<span class="sd">        |    10525: &quot;Isostatic Residual&quot;</span>
<span class="sd">        |    10540: &quot;montaj plus Grav/Mag Filtering&quot;</span>
<span class="sd">        |    10541: &quot;montaj plus Compudrape&quot;</span>
<span class="sd">        |    10550: &quot;montaj plus Praga Radiometric Processing System&quot;</span>
<span class="sd">        |    10560: &quot;montaj plus CET Grid Analysis&quot;</span>
<span class="sd">        |    10561: &quot;montaj plus CET Porphyry Analysis&quot;</span>
<span class="sd">        |    2000: &quot;ArcGIS&quot;</span>
<span class="sd">        |    3000: &quot;MapInfo&quot;</span>
<span class="sd">        |    30000: &quot;Target Surface and Drillhole Mapping&quot;</span>
<span class="sd">        |    30101: &quot;Target Geochemistry&quot;</span>
<span class="sd">        |    40000: &quot;Target for ArcGIS Surface and Drillhole Mapping&quot;</span>
<span class="sd">        |    41000: &quot;Geochemistry for ArcGIS&quot;</span>
<span class="sd">        |    5104: &quot;montaj Geophysics Leveling - Basic&quot;</span>
<span class="sd">        |    5106: &quot;montaj Grav/Mag Interpretation - Basic&quot;</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ent</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entitlements</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">ent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entitlements</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entitled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if this user has a minimal Geosoft desktop licence/entitlement</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entitled</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">license_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The user&#39;s license class.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lc</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_license_class</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lc</span><span class="o">.</span><span class="n">value</span>


<div class="viewcode-block" id="GXpyContext.run_gx"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.run_gx">[docs]</a>    <span class="k">def</span> <span class="nf">run_gx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a GX.</span>

<span class="sd">        :param gx: GX name to run</span>
<span class="sd">        :returns:  success, cancelled, exit_val, error_list, warning_list</span>

<span class="sd">        .. versionadded:: 9.6</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">exit_val</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">int_ref</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">run_gx_ex</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="n">exit_val</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="n">ret</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">cancelled</span> <span class="o">=</span> <span class="n">ret</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">error_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">warning_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">num_errors_ap</span><span class="p">()):</span>
            <span class="n">err_no</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_error_ap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
            <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">get_error_message_ap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">err_no</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">warning_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">clear_err_ap</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">success</span><span class="p">,</span> <span class="n">cancelled</span><span class="p">,</span> <span class="n">exit_val</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">error_list</span><span class="p">,</span> <span class="n">warning_list</span></div>

<div class="viewcode-block" id="GXpyContext.temp_folder"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.temp_folder">[docs]</a>    <span class="k">def</span> <span class="nf">temp_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the GX temporary folder path.</span>

<span class="sd">        Each GX instance will create an instance-specific temporary folder as a child in the Geosoft</span>
<span class="sd">        temporary folder.  Placing temporary files in the GX-specific temporary folder will ensure</span>
<span class="sd">        temporary file names will not collide with other running GX-based programs, and that all</span>
<span class="sd">        temporarty files are removed on termination of this GX.</span>

<span class="sd">        Call `keep_temp_folder` to prevent deletion of the temporary files, which can be useful</span>
<span class="sd">        when debugging.</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># create a temporary folder for this GX instance</span>

            <span class="n">path</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_temp</span><span class="p">()</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="s2">&quot;_gx_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">uuid</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_keep_temp_files</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_folder</span> <span class="o">=</span> <span class="n">path</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_keep_temp_files</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_folder</span></div>

    <span class="k">def</span> <span class="nf">_clean_redist_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_redist_user_dir_cleanup&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir_cleanup</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_user_dir</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_redist_user_temp_cleanup&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir_cleanup</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redist_temp_dir</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="GXpyContext.keep_temp_folder"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.keep_temp_folder">[docs]</a>    <span class="k">def</span> <span class="nf">keep_temp_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Keep temporary file folder setting.</span>

<span class="sd">        :param keep: True to keep the temporary file folder, False to remove</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keep_temp_files</span> <span class="o">=</span> <span class="n">keep</span></div>

<div class="viewcode-block" id="GXpyContext.temp_file"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.temp_file">[docs]</a>    <span class="k">def</span> <span class="nf">temp_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a unique temporary file name as a full path.  The temporary file is created in</span>
<span class="sd">        the instance temporary folder and will be deleted when this GXpy instance is deleted.</span>

<span class="sd">        :param ext: optional extension</span>
<span class="sd">        :returns:   uuid-based file name in the instance temporary folder.</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ext</span> <span class="ow">and</span> <span class="n">ext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span><span class="p">(),</span> <span class="n">gxu</span><span class="o">.</span><span class="n">uuid</span><span class="p">()</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span></div>

<div class="viewcode-block" id="GXpyContext.environment"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.environment">[docs]</a>    <span class="k">def</span> <span class="nf">environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formated_indent</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 replaced by properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gid</span><span class="p">,</span>
                <span class="s1">&#39;current_date&#39;</span><span class="p">:</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
                <span class="s1">&#39;current_utc_date&#39;</span><span class="p">:</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">utc_date</span><span class="p">(),</span>
                <span class="s1">&#39;current_time&#39;</span><span class="p">:</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
                <span class="s1">&#39;current_utc_time&#39;</span><span class="p">:</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXSYS</span><span class="o">.</span><span class="n">utc_time</span><span class="p">(),</span>
                <span class="s1">&#39;license_class&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">license_class</span><span class="p">(),</span>
                <span class="s1">&#39;folder_workspace&#39;</span><span class="p">:</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_workspace</span><span class="p">(),</span>
                <span class="s1">&#39;folder_temp&#39;</span><span class="p">:</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_temp</span><span class="p">(),</span>
                <span class="s1">&#39;folder_user&#39;</span><span class="p">:</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_user</span><span class="p">(),</span>
                <span class="p">}</span>

        <span class="k">if</span> <span class="n">formated_indent</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="n">formated_indent</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">info</span></div>

<div class="viewcode-block" id="GXpyContext.log"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.log">[docs]</a>    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log a string to the log file or log call-back as defined when creating :class:`GXpy` instance.</span>

<span class="sd">        :param args: arguments to log, each will be converted to a str()</span>

<span class="sd">        If logging to a file each line is preceded by the date and time:</span>

<span class="sd">        .. code::</span>

<span class="sd">            2016-12-25 12:34:16.175 log_str_line_1</span>
<span class="sd">            2016-12-25 12:34:16.175 log_str_line_2</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_it</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_log_it&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_it</span><span class="p">:</span>
            <span class="n">log_it</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="GXpyContext.close_log"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.close_log">[docs]</a>    <span class="k">def</span> <span class="nf">close_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;close logging&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;GX closed&#39;</span><span class="p">)</span>
        <span class="n">logf</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_logf&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">logf</span><span class="p">:</span>
            <span class="n">logf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="GXpyContext.elapsed_seconds"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.elapsed_seconds">[docs]</a>    <span class="k">def</span> <span class="nf">elapsed_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the elapsed seconds since this GX instance started.</span>
<span class="sd">        The elapsed time is logged if logging is on.</span>

<span class="sd">        :param log:     True to log, which also requires logging to be on</span>
<span class="sd">        :param tag:     optional string to add to the log</span>
<span class="sd">        :returns:       elapsed time in seconds</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span>
        <span class="n">elapsed_seconds</span> <span class="o">=</span> <span class="n">elapsed</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">elapsed</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">1000000.0</span>
        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tag</span><span class="p">:</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&gt; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">Elapsed seconds: </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> minutes, </span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1"> seconds)&#39;</span><span class="o">.</span>
                     <span class="nb">format</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span>
                            <span class="n">elapsed_seconds</span><span class="p">,</span>
                            <span class="n">elapsed</span><span class="o">.</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">60</span><span class="p">,</span>
                            <span class="n">elapsed</span><span class="o">.</span><span class="n">seconds</span> <span class="o">%</span> <span class="mi">60</span><span class="p">,</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">elapsed</span><span class="o">.</span><span class="n">microseconds</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">elapsed_seconds</span></div>

    <span class="c1">####################################################</span>
    <span class="c1"># deprecated</span>

<div class="viewcode-block" id="GXpyContext.folder_workspace"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.folder_workspace">[docs]</a>    <span class="k">def</span> <span class="nf">folder_workspace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 use :meth:`geosoft.gxpy.utility.folder_workspace`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_workspace</span><span class="p">()</span></div>

<div class="viewcode-block" id="GXpyContext.folder_temp"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.folder_temp">[docs]</a>    <span class="k">def</span> <span class="nf">folder_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 use :meth:`geosoft.gxpy.utility.folder_temp`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_temp</span><span class="p">()</span></div>

<div class="viewcode-block" id="GXpyContext.folder_user"><a class="viewcode-back" href="../../../geosoft.gxpy.gx.html#geosoft.gxpy.gx.GXpyContext.folder_user">[docs]</a>    <span class="k">def</span> <span class="nf">folder_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 use :meth:`geosoft.gxpy.utility.folder_user`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gxu</span><span class="o">.</span><span class="n">folder_user</span><span class="p">()</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Geosoft GX Python API 9.10.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geosoft.gxpy.gx</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Geosoft Inc.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>