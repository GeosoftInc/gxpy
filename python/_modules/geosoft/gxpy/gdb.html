

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>geosoft.gxpy.gdb &#8212; Geosoft GX Python API 2022.1.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/maki.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-87443115-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Geosoft GX Python API 2022.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geosoft.gxpy.gdb</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Introduction</a></li>
    <li><a href="../../index.html">Module code</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geosoft.gxpy.gdb</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Geosoft databases for line-oriented spatial data.</span>

<span class="sd">:Classes:</span>
<span class="sd">    :`Geosoft_gdb`: Geosoft line database</span>
<span class="sd">    :`Line`:        line handling</span>
<span class="sd">    :`Channel`:     channel handling</span>
<span class="sd">    </span>
<span class="sd">:Constants:</span>
<span class="sd">    :LINE_TYPE_NORMAL: `geosoft.gxapi.DB_LINE_TYPE_NORMAL`</span>
<span class="sd">    :LINE_TYPE_BASE: `geosoft.gxapi.DB_LINE_TYPE_BASE`</span>
<span class="sd">    :LINE_TYPE_TIE: `geosoft.gxapi.DB_LINE_TYPE_TIE`</span>
<span class="sd">    :LINE_TYPE_TEST: `geosoft.gxapi.DB_LINE_TYPE_TEST`</span>
<span class="sd">    :LINE_TYPE_TREND: `geosoft.gxapi.DB_LINE_TYPE_TREND`</span>
<span class="sd">    :LINE_TYPE_SPECIAL: `geosoft.gxapi.DB_LINE_TYPE_SPECIAL`</span>
<span class="sd">    :LINE_TYPE_RANDOM: `geosoft.gxapi.DB_LINE_TYPE_RANDOM`</span>

<span class="sd">    :LINE_CATEGORY_FLIGHT: `geosoft.gxapi.DB_CATEGORY_LINE_FLIGHT`</span>
<span class="sd">    :LINE_CATEGORY_GROUP: `geosoft.gxapi.DB_CATEGORY_LINE_GROUP`</span>
<span class="sd">    :LINE_CATEGORY_NORMAL: `geosoft.gxapi.DB_CATEGORY_LINE_NORMAL`</span>

<span class="sd">    :FORMAT_NORMAL: `geosoft.gxapi.DB_CHAN_FORMAT_NORMAL`</span>
<span class="sd">    :FORMAT_EXP: `geosoft.gxapi.DB_CHAN_FORMAT_EXP`</span>
<span class="sd">    :FORMAT_TIME: `geosoft.gxapi.DB_CHAN_FORMAT_TIME`</span>
<span class="sd">    :FORMAT_DATE: `geosoft.gxapi.DB_CHAN_FORMAT_DATE`</span>
<span class="sd">    :FORMAT_GEOGR: `geosoft.gxapi.DB_CHAN_FORMAT_GEOGR`</span>
<span class="sd">    :FORMAT_SIGDIG: `geosoft.gxapi.DB_CHAN_FORMAT_SIGDIG`</span>
<span class="sd">    :FORMAT_HEX: `geosoft.gxapi.DB_CHAN_FORMAT_HEX`</span>

<span class="sd">    :CHAN_ALL: None</span>
<span class="sd">    :CHAN_NORMAL: 0</span>
<span class="sd">    :CHAN_ARRAY: 1</span>
<span class="sd">    :CHAN_DISPLAYED: 2</span>

<span class="sd">    :SYMB_LINE_NORMAL: `geosoft.gxapi.DB_CATEGORY_LINE_NORMAL`</span>
<span class="sd">    :SYMB_LINE_FLIGHT: `geosoft.gxapi.DB_CATEGORY_LINE_FLIGHT`</span>
<span class="sd">    :SYMB_LINE_GROUP: `geosoft.gxapi.DB_CATEGORY_LINE_GROUP`</span>

<span class="sd">    :SELECT_INCLUDE: `geosoft.gxapi.DB_LINE_SELECT_INCLUDE`</span>
<span class="sd">    :SELECT_EXCLUDE: `geosoft.gxapi.DB_LINE_SELECT_EXCLUDE`</span>

<span class="sd">    :COMP_NONE: `geosoft.gxapi.DB_COMP_NONE`</span>
<span class="sd">    :COMP_SPEED: `geosoft.gxapi.DB_COMP_SPEED`</span>
<span class="sd">    :COMP_SIZE: `geosoft.gxapi.DB_COMP_SIZE`</span>

<span class="sd">    :READ_REMOVE_DUMMYROWS: 1</span>
<span class="sd">    :READ_REMOVE_DUMMYCOLUMNS: 2</span>

<span class="sd">    :SYMBOL_LOCK_NONE: `geosoft.gxapi.DB_LOCK_NONE`</span>
<span class="sd">    :SYMBOL_LOCK_READ: `geosoft.gxapi.DB_LOCK_READONLY`</span>
<span class="sd">    :SYMBOL_LOCK_WRITE: `geosoft.gxapi.DB_LOCK_READWRITE`</span>

<span class="sd">    :DRAW_AS_POINTS: 0</span>
<span class="sd">    :DRAW_AS_LINES: 1</span>
<span class="sd">    </span>
<span class="sd">.. seealso:: `geosoft.gxapi.GXGB`, `geosoft.gxapi.GXEDB`,</span>
<span class="sd">             `geosoft.gxapi.GXDBREAD`, `geosoft.gxapi.GXDBWRITE`</span>

<span class="sd">.. note::</span>

<span class="sd">    Regression tests provide usage examples: </span>
<span class="sd">    `Tests &lt;https://github.com/GeosoftInc/gxpy/blob/master/geosoft/gxpy/tests/test_gdb.py&gt;`_</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">geosoft</span>
<span class="kn">import</span> <span class="nn">geosoft.gxapi</span> <span class="k">as</span> <span class="nn">gxapi</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">vv</span> <span class="k">as</span> <span class="n">gxvv</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">va</span> <span class="k">as</span> <span class="n">gxva</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utility</span> <span class="k">as</span> <span class="n">gxu</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">gx</span> <span class="k">as</span> <span class="n">gx</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">coordinate_system</span> <span class="k">as</span> <span class="n">gxcs</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">metadata</span> <span class="k">as</span> <span class="n">gxmeta</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="nb">map</span> <span class="k">as</span> <span class="n">gxmap</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">view</span> <span class="k">as</span> <span class="n">gxview</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">group</span> <span class="k">as</span> <span class="n">gxgroup</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">geometry</span> <span class="k">as</span> <span class="n">gxgeo</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">__version__</span>


<span class="k">def</span> <span class="nf">_t</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">gxpy</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="n">LINE_TYPE_NORMAL</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_NORMAL</span>
<span class="n">LINE_TYPE_BASE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_BASE</span>
<span class="n">LINE_TYPE_TIE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_TIE</span>
<span class="n">LINE_TYPE_TEST</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_TEST</span>
<span class="n">LINE_TYPE_TREND</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_TREND</span>
<span class="n">LINE_TYPE_SPECIAL</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_SPECIAL</span>
<span class="n">LINE_TYPE_RANDOM</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_TYPE_RANDOM</span>

<span class="n">LINE_CATEGORY_FLIGHT</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_FLIGHT</span>
<span class="n">LINE_CATEGORY_GROUP</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_GROUP</span>
<span class="n">LINE_CATEGORY_NORMAL</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_NORMAL</span>

<span class="n">FORMAT_NORMAL</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_NORMAL</span>
<span class="n">FORMAT_EXP</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_EXP</span>
<span class="n">FORMAT_TIME</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_TIME</span>
<span class="n">FORMAT_DATE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_DATE</span>
<span class="n">FORMAT_GEOGR</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_GEOGR</span>
<span class="n">FORMAT_SIGDIG</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_SIGDIG</span>
<span class="n">FORMAT_HEX</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_FORMAT_HEX</span>

<span class="n">CHAN_ALL</span> <span class="o">=</span> <span class="kc">None</span>    
<span class="n">CHAN_NORMAL</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">CHAN_ARRAY</span> <span class="o">=</span> <span class="mi">1</span>     
<span class="n">CHAN_DISPLAYED</span> <span class="o">=</span> <span class="mi">2</span> 

<span class="n">SYMB_LINE_NORMAL</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_NORMAL</span>
<span class="n">SYMB_LINE_FLIGHT</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_FLIGHT</span>
<span class="n">SYMB_LINE_GROUP</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_GROUP</span>

<span class="n">SELECT_INCLUDE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_INCLUDE</span>
<span class="n">SELECT_EXCLUDE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_EXCLUDE</span>

<span class="n">COMP_NONE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_COMP_NONE</span>
<span class="n">COMP_SPEED</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_COMP_SPEED</span>
<span class="n">COMP_SIZE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_COMP_SIZE</span>

<span class="n">READ_REMOVE_DUMMYROWS</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">READ_REMOVE_DUMMYCOLUMNS</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">SYMBOL_LOCK_NONE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LOCK_NONE</span>
<span class="n">SYMBOL_LOCK_READ</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LOCK_READONLY</span>
<span class="n">SYMBOL_LOCK_WRITE</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LOCK_READWRITE</span>

<span class="n">DRAW_AS_POINTS</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">DRAW_AS_LINES</span> <span class="o">=</span> <span class="mi">1</span>


<div class="viewcode-block" id="GdbException"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.GdbException">[docs]</a><span class="k">class</span> <span class="nc">GdbException</span><span class="p">(</span><span class="n">geosoft</span><span class="o">.</span><span class="n">GXRuntimeError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exceptions from `geosoft.gxpy.gdb`.</span>

<span class="sd">    .. versionadded:: 9.1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="k">def</span> <span class="nf">_gdb_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">name_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name_ext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;.gdb&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.gdb&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_va_width</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s2">&quot;Only one or two-dimensional data allowed.&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">width</span>


<div class="viewcode-block" id="is_valid_line_name"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.is_valid_line_name">[docs]</a><span class="k">def</span> <span class="nf">is_valid_line_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return True if this is a valid line name.</span>

<span class="sd">    See also `create_line_name`</span>

<span class="sd">    .. versionadded:: 9.3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">GXDB</span><span class="o">.</span><span class="n">is_line_name</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>


<div class="viewcode-block" id="create_line_name"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.create_line_name">[docs]</a><span class="k">def</span> <span class="nf">create_line_name</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">line_type</span><span class="o">=</span><span class="n">LINE_TYPE_NORMAL</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a valid database line name constructed from the component parts.</span>

<span class="sd">    :param number:      line number, or a string, default is 0</span>
<span class="sd">    :param line_type:   one of LINE_TYPE constants, default is LINE_TYPE_NORMAL</span>
<span class="sd">    :param version:     version number, default is 0</span>

<span class="sd">    :return:        string line name</span>

<span class="sd">    Line name strings are constructed using the line naming convention as in the following:</span>

<span class="sd">        ====== =======================================</span>
<span class="sd">        L10.4  LINE_TYPE_NORMAL, number 10, version 4</span>
<span class="sd">        B10.4  LINE_TYPE_BASE, number 10, version 4</span>
<span class="sd">        D10.4  LINE_TYPE_RANDOM, number 10, version 4</span>
<span class="sd">        P10.4  LINE_TYPE_SPECIAL, number 10, version 4</span>
<span class="sd">        T10.4  LINE_TYPE_TIE, number 10, version 4</span>
<span class="sd">        S10.4  LINE_TYPE_TEST, number 10, version 4</span>
<span class="sd">        R10.4  LINE_TYPE_TREND, number 10, version 4</span>
<span class="sd">        ====== =======================================</span>

<span class="sd">    .. versionadded:: 9.3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
    <span class="n">gxapi</span><span class="o">.</span><span class="n">GXDB</span><span class="o">.</span><span class="n">set_line_name2</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">),</span> <span class="n">line_type</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span></div>


<div class="viewcode-block" id="delete_files"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.delete_files">[docs]</a><span class="k">def</span> <span class="nf">delete_files</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete all files associates with this database name.</span>

<span class="sd">    :param file_name:   name of the database</span>

<span class="sd">    .. versionadded:: 9.3</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">_gdb_name</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">root</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;.gdb&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;File is not a Geosoft database file (no gdb extension): </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">)))</span>

        <span class="n">gxu</span><span class="o">.</span><span class="n">delete_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">gxu</span><span class="o">.</span><span class="n">delete_file</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;.xml&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Geosoft_gdb"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb">[docs]</a><span class="k">class</span> <span class="nc">Geosoft_gdb</span><span class="p">(</span><span class="n">gxgeo</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to work with Geosoft databases. This class wraps many of the functions found in </span>
<span class="sd">    `geosoft.gxapi.GXDB`.</span>

<span class="sd">    :Constructors:</span>
<span class="sd">     </span>
<span class="sd">        ========= =========================================================================</span>
<span class="sd">        `open`    open an existing file, or if not specified open/lock the current database</span>
<span class="sd">        `new`     create a new database</span>
<span class="sd">        ========= =========================================================================</span>

<span class="sd">    **Some typical programming patterns**</span>

<span class="sd">    Python Oasis extension opens and reads through all data in the current database:</span>

<span class="sd">    .. code::</span>

<span class="sd">        import os,sys</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        import gxpy.gx as gxp</span>
<span class="sd">        import gxpy.gdb as gxdb</span>

<span class="sd">        # open the current database in the open project</span>
<span class="sd">        gdb = gxdb.Geosoft_gdb.open()</span>
<span class="sd">        for line in gdb.list_lines():</span>

<span class="sd">            npd,ch,fid = gdb.read_line(line)</span>
<span class="sd">            # npd is a 2D numpy array to all data in this line.</span>
<span class="sd">            # ch is a list of the channels, one channel for each column in npd.</span>
<span class="sd">            # Array channels are expanded with channel names &quot;name[0]&quot;, &quot;name[1]&quot; ...</span>
<span class="sd">            # fid is a tuple (start,increment) fiducial, which will be the minimum start and smallest increment.</span>

<span class="sd">            # ... do something with the data in npd ...</span>

<span class="sd">    External Python program to open and read through all data in a database:</span>

<span class="sd">    .. code::</span>

<span class="sd">        import os,sys</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        import gxpy.gx as gx</span>
<span class="sd">        import gxpy.gdb as gxdb</span>

<span class="sd">        # initalize the gx environment - required for external programs.</span>
<span class="sd">        gxp = gx.GXpy()</span>
<span class="sd">    </span>
<span class="sd">        # open a database</span>
<span class="sd">        gdb = gxdb.Geosoft_gdb.open(&#39;test.gdb&#39;)</span>
<span class="sd">        for line in gdb.list_lines():</span>

<span class="sd">            npd,ch,fid = gdb.read_line(line)</span>
<span class="sd">            # npd is a 2D numpy array to all data in this line.</span>
<span class="sd">            # ch is a list of the channels, one channel for each column in npd.</span>
<span class="sd">            # Array channels are expanded with channel names &quot;name[0]&quot;, &quot;name[1]&quot; ...</span>
<span class="sd">            # fid is a tuple (start,increment) fiducial, which will be the minimum start and smallest increment.</span>

<span class="sd">            # ... do something with the data in npd ...</span>

<span class="sd">    The following creates a new channel that is the distance from the origin to the X,Y,Z location of every point.</span>

<span class="sd">    .. code::</span>

<span class="sd">        ...</span>
<span class="sd">        gdb = gxdb.Geosoft_gdb.open(&#39;test.gdb&#39;)</span>
<span class="sd">        for line in gdb.list_lines():</span>

<span class="sd">            npd,ch,fid = gdb.read_line(line, channels=[&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;])</span>

<span class="sd">            npd = np.square(npd)</span>
<span class="sd">            distance_from_origin = np.sqrt(npd[0] + npd[1] + npd[2])</span>

<span class="sd">            gdb.write_channel(line, &#39;distance&#39;, distance_from_origin, fid)</span>

<span class="sd">    .. versionadded:: 9.1</span>

<span class="sd">    .. versionchanged:: 9.3 float numpy arrays use np.nan for dummies so dummy filtering no longer necessary.</span>

<span class="sd">    .. versionchanged:: 9.3.1 inherits from `geosoft.gxpy.geometry.Geometry`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_type</span><span class="p">,</span> <span class="n">_value</span><span class="p">,</span> <span class="n">_traceback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__del__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_close&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">discard</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_open&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edb</span><span class="o">.</span><span class="n">is_locked</span><span class="p">():</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_edb</span><span class="o">.</span><span class="n">un_lock</span><span class="p">()</span>
                        <span class="n">discard</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edb</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">discard</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_changed</span><span class="p">:</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span> <span class="o">+</span> <span class="s1">&#39;.xml&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gxu</span><span class="o">.</span><span class="n">xml_from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">sync</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">discard</span><span class="p">:</span>
                    <span class="n">gxu</span><span class="o">.</span><span class="n">delete_files_by_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pop</span><span class="p">:</span>
                    <span class="n">gx</span><span class="o">.</span><span class="n">pop_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_open</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_open</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">(</span><span class="si">{}</span><span class="s1"> lines, </span><span class="si">{}</span><span class="s1"> channels)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">used_lines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">used_channels</span><span class="p">)</span>

<div class="viewcode-block" id="Geosoft_gdb.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lst</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXLST</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_changed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_root</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xyz&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;extent&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_name</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_NAME_FILE</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_gdb_&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_open</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">track_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.close"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discard</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close the database and free resources</span>

<span class="sd">        :param discard: True to discard the database files(s) after closing.</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">discard</span><span class="o">=</span><span class="n">discard</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.open"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.open">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open an existing database.</span>

<span class="sd">        :param name:    name of the database, default is the current project database</span>
<span class="sd">        :returns:       `Geosoft_gdb` instance</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gdb</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gdb</span><span class="o">.</span><span class="n">_edb</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXEDB</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
            <span class="n">gdb</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXEDB</span><span class="o">.</span><span class="n">lock</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">_edb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gdb</span><span class="o">.</span><span class="n">_edb</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">gdb</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXDB</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">_gdb_name</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="s1">&#39;SUPER&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="n">gdb</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_name</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_NAME_FILE</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="n">gdb</span><span class="o">.</span><span class="n">_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gdb</span></div>

<div class="viewcode-block" id="Geosoft_gdb.new"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.new">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_lines</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_channels</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">max_blobs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
            <span class="n">comp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new database.</span>

<span class="sd">        :param name:            database name, if None a temporary database is created</span>
<span class="sd">        :param max_lines:       maximum number of lines, default 500</span>
<span class="sd">        :param max_channels:    maximum number of channels, default 200</span>
<span class="sd">        :param max_blobs:       maximum number of blobs, default lines*channels+20</span>
<span class="sd">        :param comp:            compression:</span>

<span class="sd">                                | COMP_NONE</span>
<span class="sd">                                | COMP_SPEED (default)</span>
<span class="sd">                                | COMP_SIZE</span>
<span class="sd">                                </span>
<span class="sd">        :param overwrite:       `True` to overwrite existing database. Default is `False`, GdbException if file exists.</span>
<span class="sd">        :param page_size:       page size (default is 1024), which limits the amount of compressed data that can be </span>
<span class="sd">                                stored in a single channel on a line. The maximum compressed data size for a channel</span>
<span class="sd">                                will be this number * 65534 (default 1024 * 65534 = 64 MB of compressed data). </span>
<span class="sd">                                This will be forced to a power of 2 between 64 and 4096, which would allow for a </span>
<span class="sd">                                maximum of 256 MB compressed data per channel per line.</span>
<span class="sd">                            </span>
<span class="sd">        :returns:               `Geosoft_gdb` instance</span>

<span class="sd">        .. versionadded:: 9.1</span>

<span class="sd">        .. versionchanged:: 9.3</span>
<span class="sd">            added parameter `overwrite=False`</span>

<span class="sd">        .. versionchanged:: 9.4 `name=None` creates a temporary database</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_lines</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_lines</span><span class="p">)</span>
        <span class="n">max_channels</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">max_channels</span><span class="p">)</span>
        <span class="n">min_blobs</span> <span class="o">=</span> <span class="n">max_channels</span> <span class="o">+</span> <span class="n">max_lines</span> <span class="o">+</span> <span class="mi">20</span>
        <span class="n">max_blobs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_blobs</span><span class="p">,</span> <span class="n">max_blobs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">comp</span><span class="p">:</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="n">COMP_SPEED</span>

        <span class="c1"># validate page_size:</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="mi">64</span>
        <span class="k">while</span> <span class="n">ps</span> <span class="o">&lt;</span> <span class="n">page_size</span><span class="p">:</span>
            <span class="n">ps</span> <span class="o">*=</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">ps</span> <span class="o">&gt;</span> <span class="mi">4096</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Page size cannot be larger than 4096 (256 MB per line-channel).&#39;</span><span class="p">))</span>
        <span class="n">page_size</span> <span class="o">=</span> <span class="n">ps</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">gx</span><span class="p">()</span><span class="o">.</span><span class="n">temp_file</span><span class="p">(</span><span class="s1">&#39;gdb&#39;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">_gdb_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Cannot overwrite existing database </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>
        <span class="n">gxu</span><span class="o">.</span><span class="n">delete_files_by_root</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">gxapi</span><span class="o">.</span><span class="n">GXDB</span><span class="o">.</span><span class="n">create_comp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                               <span class="n">max_lines</span><span class="p">,</span> <span class="n">max_channels</span><span class="p">,</span> <span class="n">max_blobs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>
                               <span class="s1">&#39;SUPER&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                               <span class="n">page_size</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.commit"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.commit">[docs]</a>    <span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Commit database changes.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span></div>

<div class="viewcode-block" id="Geosoft_gdb.discard"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.discard">[docs]</a>    <span class="k">def</span> <span class="nf">discard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discard database changes.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">discard</span><span class="p">()</span></div>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># internal helper functions</span>

<div class="viewcode-block" id="Geosoft_gdb.exist_symb_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.exist_symb_">[docs]</a>    <span class="k">def</span> <span class="nf">exist_symb_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symb</span><span class="p">,</span> <span class="n">symb_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a symbol exists of the required type.</span>
<span class="sd">        </span>
<span class="sd">        :param symb:        symbol name, number or instance</span>
<span class="sd">        :param symb_type:   one of DB_SYMB_TYPE</span>
<span class="sd">        :returns:           `True` if the symbol exists and is the expected symbol type, `False` otherwise</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">exist_symb</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">symb_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">valid_symb</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">symb_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">Line</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">symb_type</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">Channel</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">symb_type</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># Information</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gxdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The `geosoft.gxapi.GXDB` instance handle&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xyz_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The currently identified (x, y, z) channels.  Methods that work on spatial locations will use these</span>
<span class="sd">        channels for locating the data at each fiducial of the data.  Can be set using a tuple of two or</span>
<span class="sd">        three strings.  For example:</span>
<span class="sd">        </span>
<span class="sd">        .. code::</span>
<span class="sd">        </span>
<span class="sd">            gdb.xyz_channels = (&#39;Easting&#39;, &#39;Northing&#39;)</span>
<span class="sd">            gdb.xyz_channels = (&#39;Easting&#39;, &#39;Northing&#39;, &#39;Elevation&#39;)</span>
<span class="sd">            </span>
<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_xyz_chan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_xyz_chan</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_xyz_chan</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>

    <span class="nd">@xyz_channels</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">xyz_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyz</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">xyz</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_channel</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xyz</span>
            <span class="n">z</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_channel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_channel</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_xyz_chan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_xyz_chan</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">z</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_xyz_chan</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_extent</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init_xmlmetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">geosoft_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_root</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the database XML metadata as a dictionary.  Can be set, in which case</span>
<span class="sd">        the dictionary items passed will be added to, or replace existing XML metadata.</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_xmlmetadata</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_root</span><span class="p">]</span>

    <span class="nd">@metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_xmlmetadata</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_root</span><span class="p">]</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">merge_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_root</span><span class="p">],</span> <span class="n">meta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xmlmetadata_changed</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Geosoft_gdb.get_gx_metadata"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.get_gx_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_gx_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the database Geosoft metadata as a Geosoft `geosoft.gxpy.metadata.Metadata` instance.</span>

<span class="sd">        The internal database metadata is used to store various database properties that are not intended</span>
<span class="sd">        to be part of the exposed dataset metadata exposed by the :attr:metadata property.</span>

<span class="sd">        If you wish to add your own metadata to the internal properties you can use the</span>
<span class="sd">        `geosoft.gxpy.metadata` module to add metadata and save it to the database using</span>
<span class="sd">        `geosoft.gxapi.GXDB.set_meta`.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gxm</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXMETA</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">gxm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gxmeta</span><span class="o">.</span><span class="n">Metadata</span><span class="p">(</span><span class="n">gxm</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.update_gxmeta"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.update_gxmeta">[docs]</a>    <span class="k">def</span> <span class="nf">update_gxmeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_meta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the database Geosoft metadata as a Geosoft `geosoft.gxpy.metadata.Metadata` instance.</span>

<span class="sd">        :param meta:    the new metadata as a `geosoft.gxpy.Metadata` instance or a nested dict.</span>

<span class="sd">        .. versionadded:: 9.3.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">current_meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gx_metadata</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_meta</span><span class="p">,</span> <span class="n">gxmeta</span><span class="o">.</span><span class="n">Metadata</span><span class="p">):</span>
            <span class="n">new_meta</span> <span class="o">=</span> <span class="n">new_meta</span><span class="o">.</span><span class="n">meta_dict</span><span class="p">()</span>
        <span class="n">current_meta</span><span class="o">.</span><span class="n">update_dict</span><span class="p">(</span><span class="n">new_meta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="n">current_meta</span><span class="o">.</span><span class="n">gxmeta</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Database file name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coordinate_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coordinate system of the current `xyz_channels`.</span>
<span class="sd">        Can be set from any `geosoft.gxpy.coordinate_system.Coordinate_system` constructor.</span>

<span class="sd">        .. versionchanged:: 9.3</span>
<span class="sd">            added setter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span>
            <span class="n">ipj</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXIPJ</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_ipj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ipj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">gxcs</span><span class="o">.</span><span class="n">Coordinate_system</span><span class="p">(</span><span class="n">ipj</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gxcs</span><span class="o">.</span><span class="n">Coordinate_system</span><span class="p">()</span>

    <span class="nd">@coordinate_system</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">coordinate_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">gxcs</span><span class="o">.</span><span class="n">Coordinate_system</span><span class="p">):</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">gxcs</span><span class="o">.</span><span class="n">Coordinate_system</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_ipj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cs</span><span class="o">.</span><span class="n">gxipj</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span>
        <span class="k">if</span> <span class="n">z</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">z</span><span class="o">.</span><span class="n">unit_of_measure</span><span class="p">:</span>
                <span class="n">z</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">unit_of_measure</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_blobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;maximum blobs allowed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_BLOBS_MAX</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;maximum number of lines allowed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_LINES_MAX</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;maximum number of channels allowed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_CHANS_MAX</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">used_blobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;number of blobs used&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_BLOBS_USED</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">used_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;number of lines used&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_LINES_USED</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">used_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;number of channels used&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_CHANS_USED</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_compressed_channel_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;maximum compressed data per channel per line in bytes&quot;&quot;&quot;</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_PAGE_SIZE</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ps</span> <span class="o">*</span> <span class="mi">65534</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;number of blocks&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_DATA_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lost_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;lost blocks that might be freed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_LOST_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">free_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;number of free blocks&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_FREE_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">compression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;database compression setting&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_COMP_LEVEL</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pages_for_blobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pages consumed by blobs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_BLOB_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">db_size_kb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;database size in kb&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_FILE_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">index_size_kb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;index size in kb&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_INDEX_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_block_size_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;maximum block size in bytes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_MAX_BLOCK_SIZE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_has_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;`True` if data has changed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_INFO_CHANGESLOST</span><span class="p">)</span>

<div class="viewcode-block" id="Geosoft_gdb.is_line"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.is_line">[docs]</a>    <span class="k">def</span> <span class="nf">is_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">raise_err</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `True` if the named line exists in the database.</span>

<span class="sd">        :param line: line name</span>
<span class="sd">        :param raise_err: True to raise an error if it does not exist</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">exist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_symb</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">)</span> <span class="o">!=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">NULLSYMB</span>
        <span class="k">if</span> <span class="n">raise_err</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; is not a line in the database&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">exist</span></div>

<div class="viewcode-block" id="Geosoft_gdb.is_channel"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.is_channel">[docs]</a>    <span class="k">def</span> <span class="nf">is_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chan</span><span class="p">,</span> <span class="n">raise_err</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `True` if the channel name exists in the database.</span>

<span class="sd">        :param chan: channel name</span>
<span class="sd">        :param raise_err: True to raise an error if it does not exist</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_chan</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">!=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">NULLSYMB</span>
        <span class="k">if</span> <span class="n">raise_err</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; is not a channel in the database&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">exist</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the spatial extent of all selected data in the database as a `geosoft.gxpy.geometry.Point2`.</span>

<span class="sd">        :returns:   `geosoft.gxpy.geometry.Point2` of minimum, maximum, or None if no spatial information.</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="n">_min</span><span class="p">,</span> <span class="n">_max</span><span class="p">,</span> <span class="n">_data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>
            <span class="n">mdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_min</span> <span class="o">=</span> <span class="n">mdata</span>
                <span class="n">_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>
            <span class="k">if</span> <span class="n">mdata</span> <span class="o">&lt;</span> <span class="n">_min</span><span class="p">:</span>
                <span class="n">_min</span> <span class="o">=</span> <span class="n">mdata</span>
                <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>
            <span class="n">mdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mdata</span> <span class="o">&gt;</span> <span class="n">_max</span><span class="p">:</span>
                <span class="n">_max</span> <span class="o">=</span> <span class="n">mdata</span>
            <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>

            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span><span class="p">[</span><span class="s1">&#39;extent&#39;</span><span class="p">]</span>

            <span class="n">xmin</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">zmin</span> <span class="o">=</span> <span class="n">zmax</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">xyz</span><span class="p">:</span>
                <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_line</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="n">xyz</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>

            <span class="n">ext</span> <span class="o">=</span> <span class="n">gxgeo</span><span class="o">.</span><span class="n">Point2</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">zmax</span><span class="p">),</span> <span class="n">coordinate_system</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span><span class="p">[</span><span class="s1">&#39;extent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ext</span>

            <span class="k">return</span> <span class="n">ext</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

<div class="viewcode-block" id="Geosoft_gdb.lock_set_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.lock_set_">[docs]</a>    <span class="k">def</span> <span class="nf">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fn</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.line_name_symb"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.line_name_symb">[docs]</a>    <span class="k">def</span> <span class="nf">line_name_symb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return line name, symbol</span>

<span class="sd">        :param line:    line name, or symbol number</span>
<span class="sd">        :param create:  `True` to create a line if one does not exist</span>
<span class="sd">        :returns:       line name, symbol</span>
<span class="sd">        :raises:        GdbException if line not found or cannot be created</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">Line</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">line</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">symbol</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exist_symb_</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">):</span>
                <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">line</span><span class="p">,</span> <span class="n">symb</span>
            <span class="k">if</span> <span class="n">create</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Line </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> not found&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_symb_name</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">line</span></div>

<div class="viewcode-block" id="Geosoft_gdb.channel_name_symb"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.channel_name_symb">[docs]</a>    <span class="k">def</span> <span class="nf">channel_name_symb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return channel name, symbol</span>

<span class="sd">        :param chan:    channel name, or symbol number or Channel instance</span>
<span class="sd">        :returns:       line name, symbol, returns (&#39;&#39;,-1) if invalid</span>
<span class="sd">        :raises:        GdbException if channel does not exist</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chan</span><span class="p">,</span> <span class="n">Channel</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">chan</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">chan</span><span class="o">.</span><span class="n">symbol</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chan</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_symb</span><span class="p">(</span><span class="n">chan</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">symb</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Channel </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> not found&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">chan</span><span class="p">,</span> <span class="n">symb</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">exist_symb_</span><span class="p">(</span><span class="n">chan</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Channel symbol </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> not found&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)))</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_symb_name</span><span class="p">(</span><span class="n">chan</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">chan</span></div>

<div class="viewcode-block" id="Geosoft_gdb.channel_width"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.channel_width">[docs]</a>    <span class="k">def</span> <span class="nf">channel_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Channel array width, 1 for normal channels, &gt;1 for VA channels.</span>

<span class="sd">        :param channel: channel symbol or name</span>
<span class="sd">        :returns:       array dimension, 1 for non-array channels</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_col_va</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.list_channels"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.list_channels">[docs]</a>    <span class="k">def</span> <span class="nf">list_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dict of channels in the database.</span>

<span class="sd">        :param chan: channel filter, default CHAN_ALL:</span>

<span class="sd">            =============== ============================</span>
<span class="sd">            CHAN_ALL        all channels, normal and VA</span>
<span class="sd">            CHAN_NORMAL     normal channels only</span>
<span class="sd">            CHAN_ARRAY      VA channels only</span>
<span class="sd">            =============== ============================</span>

<span class="sd">        :returns:   dictionary {channel_names: channel_symbols}</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">clean_chan_dict</span><span class="p">():</span>
            <span class="sd">&quot;&quot;&quot; returns list without any temporary VA sliced channels &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">chan_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
            <span class="n">_dct</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">dict_from_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
            <span class="n">cdct</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">ck</span> <span class="ow">in</span> <span class="n">_dct</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;[&#39;</span> <span class="ow">in</span> <span class="n">ck</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">cdct</span><span class="p">[</span><span class="n">ck</span><span class="p">]</span> <span class="o">=</span> <span class="n">_dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ck</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cdct</span>

        <span class="k">if</span> <span class="n">chan</span> <span class="o">==</span> <span class="n">CHAN_ALL</span><span class="p">:</span>
            <span class="n">dct</span> <span class="o">=</span> <span class="n">clean_chan_dict</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">array_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
            <span class="n">va</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">dict_from_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">==</span> <span class="n">CHAN_ARRAY</span><span class="p">:</span>
                <span class="n">dct</span> <span class="o">=</span> <span class="n">va</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># filter VA channels out of the list</span>
                <span class="n">allc</span> <span class="o">=</span> <span class="n">clean_chan_dict</span><span class="p">()</span>
                <span class="n">va</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">va</span><span class="p">)</span>
                <span class="n">dct</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">allc</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">va</span><span class="p">):</span>
                        <span class="n">dct</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">allc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

        <span class="c1"># convert symbol strings to ints</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dct</span><span class="p">:</span>
            <span class="n">dct</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">dct</span></div>

<div class="viewcode-block" id="Geosoft_gdb.lines"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.lines">[docs]</a>    <span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 use list_lines()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_lines</span><span class="p">(</span><span class="n">select</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.list_lines"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.list_lines">[docs]</a>    <span class="k">def</span> <span class="nf">list_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of lines in the database, returned as a {name: symbol} dictionary</span>
<span class="sd">        </span>
<span class="sd">        :param select:  `True` to return selected lines, `False` to return all lines</span>
<span class="sd">        :returns:       dictionary (line name: symbol)</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">select</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">selected_line_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">dict_from_lst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lst</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dct</span><span class="p">:</span>
            <span class="n">dct</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dct</span></div>

<div class="viewcode-block" id="Geosoft_gdb.line_details"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.line_details">[docs]</a>    <span class="k">def</span> <span class="nf">line_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return dictionary of line details</span>

<span class="sd">        :param line:    channel name or symbol</span>
<span class="sd">        :returns:       dictionary:</span>

<span class="sd">            =========== ==============================================================</span>
<span class="sd">            Key         Meaning</span>
<span class="sd">            =========== ==============================================================</span>
<span class="sd">            name        line name</span>
<span class="sd">            symbol      line symbol</span>
<span class="sd">            type        line type, one of gxapi.DB_LINE_TYPE</span>
<span class="sd">            category    one of SYMB_LINE</span>
<span class="sd">            date        date of the line</span>
<span class="sd">            number      numeric line number</span>
<span class="sd">            flight      flight number</span>
<span class="sd">            version     line version number</span>
<span class="sd">            groupclass  class name for grouped lines, None if not a grouped line</span>
<span class="sd">            =========== ==============================================================</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
                <span class="n">fn</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">gxapi</span><span class="o">.</span><span class="n">GXAPIError</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">detail</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ln</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_category</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_date</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;flight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_flight</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_number</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_version</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_type</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">line_category</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CATEGORY_LINE_GROUP</span><span class="p">:</span>
                <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;groupclass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_group_class</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;groupclass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">detail</span></div>

<div class="viewcode-block" id="Geosoft_gdb.channel_details"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.channel_details">[docs]</a>    <span class="k">def</span> <span class="nf">channel_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return dictionary of channel details</span>

<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :returns:       dictionary:</span>

<span class="sd">            ======= ==============================================================</span>
<span class="sd">            Key     Meaning</span>
<span class="sd">            ======= ==============================================================</span>
<span class="sd">            name    channel name</span>
<span class="sd">            symbol  channel symbol</span>
<span class="sd">            class   class name</span>
<span class="sd">            format  format, one of gxapi.DB_CHAN_FORMAT constants</span>
<span class="sd">            width   display width in characters</span>
<span class="sd">            decimal decimal places to display</span>
<span class="sd">            unit    measurement unit</span>
<span class="sd">            label   channel label, which can be different from the channel name</span>
<span class="sd">            protect protection: 0 can be modified; 1 protected from modification</span>
<span class="sd">            columns number data columns, 1 for normal channels, n for VA channels</span>
<span class="sd">            type    data type, one of gxapi.DB_CATEGORY_CHAN constants</span>
<span class="sd">            ======= ==============================================================</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
            <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
            <span class="n">fn</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>

        <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
        <span class="n">detail</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cn</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_class</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_format</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_decimal</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_unit</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_label</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;protect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_protect</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">detail</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_type</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">detail</span></div>

<div class="viewcode-block" id="Geosoft_gdb.set_channel_details"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.set_channel_details">[docs]</a>    <span class="k">def</span> <span class="nf">set_channel_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">detail</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set/change channel details from dictionary</span>

<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :param detail:  dictionary, see chan_details</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">set_detail</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
            <span class="n">det</span> <span class="o">=</span> <span class="n">detail</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">det</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fn</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">det</span><span class="p">)</span>

        <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">set_detail</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_class</span><span class="p">)</span>
            <span class="n">set_detail</span><span class="p">(</span><span class="s1">&#39;format&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_format</span><span class="p">)</span>
            <span class="n">set_detail</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_width</span><span class="p">)</span>
            <span class="n">set_detail</span><span class="p">(</span><span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_decimal</span><span class="p">)</span>
            <span class="n">set_detail</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_unit</span><span class="p">)</span>
            <span class="n">set_detail</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_label</span><span class="p">)</span>

            <span class="n">protect</span> <span class="o">=</span> <span class="n">detail</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;protect&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">protect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">set_chan_protect</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">protect</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.channel_dtype"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.channel_dtype">[docs]</a>    <span class="k">def</span> <span class="nf">channel_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns channel numpy dtype</span>

<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :returns:       numpy dtype</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">gxu</span><span class="o">.</span><span class="n">dtype_gx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Geosoft_gdb.channel_fid"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.channel_fid">[docs]</a>    <span class="k">def</span> <span class="nf">channel_fid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the fiducial of a line, channel</span>

<span class="sd">        :param line:    line name, symbol or Line</span>
<span class="sd">        :param channel: channel name, symbol or channel</span>
<span class="sd">        :returns:       (start,increment)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">fid_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_fid_start</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
            <span class="n">fid_incr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_fid_incr</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_incr</span></div>

    <span class="c1"># ========================================================================================</span>
    <span class="c1"># management</span>

<div class="viewcode-block" id="Geosoft_gdb.new_channel"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.new_channel">[docs]</a>    <span class="k">def</span> <span class="nf">new_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a channel symbol, create if it does not exist.</span>

<span class="sd">        :param name:        channel name</span>
<span class="sd">        :param dtype:       numpy dtype (ie. np.int64)</span>
<span class="sd">        :param array:       array columns (default is 1)</span>
<span class="sd">        :param dup:         duplicate properties of this channel (name, symbol, channel)</span>
<span class="sd">        :param details:     dictionary containing channel details, see channel_details()</span>

<span class="sd">        :returns:           channel symbol</span>

<span class="sd">        Examples:</span>

<span class="sd">        .. code::</span>

<span class="sd">            symb = gdb.newChan(&#39;X&#39;)</span>
<span class="sd">            symb = gdb.newChan(&#39;X&#39;, dtype=np.float64, details={&#39;decimal&#39;:4})</span>

<span class="sd">        .. versionadded:: 9.1</span>

<span class="sd">        .. versionchanged:: 9.3</span>
<span class="sd">            added support for duplication an existing channel via dup=</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_symb</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">symb</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">NULLSYMB</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dup</span><span class="p">:</span>
                <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">dup_symb_no_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">dup</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">create_symb_ex</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                                               <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">,</span>
                                               <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_OWN_SHARED</span><span class="p">,</span>
                                               <span class="n">gxu</span><span class="o">.</span><span class="n">gx_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span>
                                               <span class="n">array</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_channel_details</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">dup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_channel_details</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;decimal&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">symb</span></div>

<div class="viewcode-block" id="Geosoft_gdb.new_line"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.new_line">[docs]</a>    <span class="k">def</span> <span class="nf">new_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dup</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new line symbol.  If line exists an error is raised.</span>

<span class="sd">        :param line:        line name</span>
<span class="sd">        :param linetype:    line type for creating a new line, ignored if group defines</span>

<span class="sd">                                ================= =========================================</span>
<span class="sd">                                SYMB_LINE_NORMAL  normal lines, name is a string</span>
<span class="sd">                                SYMB_LINE_FLIGHT  flight lines, first letter is line type</span>
<span class="sd">                                ================= =========================================</span>

<span class="sd">        :param group:       group name for a grouped class</span>
<span class="sd">        :param dup:         duplicate from an existing line (name, symbol of Line)</span>

<span class="sd">        :returns:           line symbol</span>

<span class="sd">        .. seealso:: function `create_line_name` to create a valid line name.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dup</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_valid_line_name</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Invalid line name </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">. Use create_line_name() to create a valid name.&#39;</span><span class="o">.</span>
                                  <span class="nb">format</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span>

        <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">symb</span> <span class="o">!=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">NULLSYMB</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">((</span><span class="s1">&#39;Cannot create existing line </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">dup</span><span class="p">:</span>
            <span class="n">dup_symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">dup</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">dup_line_symb</span><span class="p">(</span><span class="n">dup_symb</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">group</span><span class="p">:</span>
                <span class="n">linetype</span> <span class="o">=</span> <span class="n">SYMB_LINE_GROUP</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">linetype</span><span class="p">:</span>
                <span class="n">linetype</span> <span class="o">=</span> <span class="n">SYMB_LINE_NORMAL</span>
            <span class="n">symb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">create_symb_ex</span><span class="p">(</span><span class="n">line</span><span class="p">,</span>
                                           <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">,</span>
                                           <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_OWN_SHARED</span><span class="p">,</span>
                                           <span class="n">linetype</span><span class="p">,</span>
                                           <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">group</span><span class="p">:</span>
                <span class="n">Line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symb</span><span class="p">)</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clear_extent</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">symb</span></div>

<div class="viewcode-block" id="Geosoft_gdb.clear_extent"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.clear_extent">[docs]</a>    <span class="k">def</span> <span class="nf">clear_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear the extent cache.</span>

<span class="sd">        .. versionadded:: 9.3.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Geosoft_gdb.delete_channel"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.delete_channel">[docs]</a>    <span class="k">def</span> <span class="nf">delete_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete channel(s) by name or symbol.</span>

<span class="sd">        :param channels: channel name or symbol, or a list of channel names or symbols</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">channels</span><span class="p">]</span>

        <span class="n">protected_channels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">protect</span><span class="p">:</span>
                    <span class="n">protected_channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">protected_channels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Cannot delete protected channels: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">protected_channels</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Geosoft_gdb.delete_line"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.delete_line">[docs]</a>    <span class="k">def</span> <span class="nf">delete_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete line(s) by name or symbol.</span>

<span class="sd">        :param lines: line name/symbol, or a list of names/symbols</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">exist_symb_</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="k">else</span> <span class="n">s</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">delete_symb</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.delete_line_data"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.delete_line_data">[docs]</a>    <span class="k">def</span> <span class="nf">delete_line_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all data in line(s) by name or symbol but keep the line.</span>

<span class="sd">        :param lines: line name/symbol, or a list of names/symbols</span>

<span class="sd">        .. versionadded:: 9.6</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="k">else</span> <span class="n">s</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delete_line_data</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_delete_line_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorted_chan_list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_dtype</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">vv</span> <span class="o">=</span> <span class="n">gxvv</span><span class="o">.</span><span class="n">GXvv</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_channel_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="n">gxva</span><span class="o">.</span><span class="n">GXva</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_channel_va</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">va</span><span class="p">)</span>

<div class="viewcode-block" id="Geosoft_gdb.select_lines"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.select_lines">[docs]</a>    <span class="k">def</span> <span class="nf">select_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change selected state of a line, or group of lines</span>
<span class="sd">        </span>
<span class="sd">        :param selection:   string representing selection, comma-delimit multiple selections, or provide a list</span>
<span class="sd">                            of selections.</span>
<span class="sd">        :param select:      `True` to select, `False` to deselect</span>

<span class="sd">        &quot;L99:800&quot; will select all lines of type &quot;L&quot; in range 99 through 800.</span>

<span class="sd">        | Use a &quot;T&quot; prefix for Tie lines.</span>
<span class="sd">        | Use an &quot;F&quot; prefix to specify lines of a specific flight.</span>
<span class="sd">        |    For example, &quot;F10&quot; would select all lines of flight 10.</span>
<span class="sd">        | Use an empty string (&quot;&quot;) to select/deselect ALL lines.</span>

<span class="sd">        Invalid line names are ignored.</span>

<span class="sd">        .. versionadded:: 9.1</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">select</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_INCLUDE</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_EXCLUDE</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clear_extent</span><span class="p">()</span></div>

    <span class="c1"># =====================================================================================</span>
    <span class="c1"># reading and writing</span>

    <span class="k">def</span> <span class="nf">_to_string_chan_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
                <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">channels</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">channels</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">]</span>


<div class="viewcode-block" id="Geosoft_gdb.sorted_chan_list"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.sorted_chan_list">[docs]</a>    <span class="k">def</span> <span class="nf">sorted_chan_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a list of sorted channels from Gdb, placing x, y and z channels (if defined) at front of list.</span>

<span class="sd">        :param channels:    list of channels, strings or symbol number.  If None, read all channels</span>

<span class="sd">        :returns:       list containing channel names</span>

<span class="sd">        .. versionadded:: 9.6</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">channels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string_chan_list</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_channels</span><span class="p">())</span>

        <span class="n">ch</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
        <span class="n">ch_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ch</span><span class="p">]</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nxlower</span> <span class="o">=</span> <span class="n">nylower</span> <span class="o">=</span> <span class="n">nzlower</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># put x,y,z at the front</span>
        <span class="n">xch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_xyz_chan_symb</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_X</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xch</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">nx</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">xch</span><span class="p">)</span>
            <span class="n">nxlower</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nxlower</span> <span class="ow">in</span> <span class="n">ch_lower</span><span class="p">:</span>
                <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>

        <span class="n">ych</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_xyz_chan_symb</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_Y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ych</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ny</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">ych</span><span class="p">)</span>
            <span class="n">nylower</span> <span class="o">=</span> <span class="n">ny</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nylower</span> <span class="ow">in</span> <span class="n">ch_lower</span><span class="p">:</span>
                <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ny</span><span class="p">)</span>

        <span class="n">zch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_xyz_chan_symb</span><span class="p">(</span><span class="n">gxapi</span><span class="o">.</span><span class="n">DB_CHAN_Z</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zch</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">nz</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">zch</span><span class="p">)</span>
            <span class="n">nzlower</span> <span class="o">=</span> <span class="n">nz</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nzlower</span> <span class="ow">in</span> <span class="n">ch_lower</span><span class="p">:</span>
                <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ch</span><span class="p">:</span>
            <span class="n">clower</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">clower</span> <span class="o">==</span> <span class="n">nxlower</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">clower</span> <span class="o">==</span> <span class="n">nylower</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">clower</span> <span class="o">==</span> <span class="n">nzlower</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">channels</span></div>

    <span class="k">def</span> <span class="nf">_expand_chan_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; expand VA channels and return lists of names, symbols and types&quot;&quot;&quot;</span>

        <span class="n">ch_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ch_symbs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c_type</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
                <span class="n">ch_symbs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
                <span class="n">c_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_type</span><span class="p">(</span><span class="n">cs</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
                    <span class="n">ccn</span><span class="p">,</span> <span class="n">ccs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">[</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
                    <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccn</span><span class="p">)</span>
                    <span class="n">ch_symbs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccs</span><span class="p">)</span>
                    <span class="n">c_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_type</span><span class="p">(</span><span class="n">cs</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">ch_symbs</span><span class="p">,</span> <span class="n">c_type</span>

<div class="viewcode-block" id="Geosoft_gdb.lock_read_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.lock_read_">[docs]</a>    <span class="k">def</span> <span class="nf">lock_read_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;internal function to lock a symbol for read&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">lock_symb</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SYMBOL_LOCK_READ</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_WAIT_INFINITY</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Cannot read lock symbol </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Geosoft_gdb.lock_write_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.lock_write_">[docs]</a>    <span class="k">def</span> <span class="nf">lock_write_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;internal function to lock a symbol for write&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">lock_symb</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SYMBOL_LOCK_WRITE</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_WAIT_INFINITY</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Cannot write lock symbol </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Geosoft_gdb.unlock_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.unlock_">[docs]</a>    <span class="k">def</span> <span class="nf">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;internal_function to unlock a symbol&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_symb_lock</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SYMBOL_LOCK_NONE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">un_lock_symb</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.unlock_all"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.unlock_all">[docs]</a>    <span class="k">def</span> <span class="nf">unlock_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unlock all locked symbols.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">un_lock_all_symb</span><span class="p">()</span></div>

<div class="viewcode-block" id="Geosoft_gdb.read_channel_vv"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.read_channel_vv">[docs]</a>    <span class="k">def</span> <span class="nf">read_channel_vv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read data from a single channel, return in a vv.</span>

<span class="sd">        :param line:    line name or symbol</span>
<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :param dtype:   type wanted, default same as the channel data</span>

<span class="sd">        :returns:       vv</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s2">&quot;Cannot read a VA channel into a VV.&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_dtype</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">gxvv</span><span class="o">.</span><span class="n">GXvv</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">vv</span><span class="o">.</span><span class="n">gxvv</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="n">vv</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span><span class="o">.</span><span class="n">unit_of_measure</span>

        <span class="k">return</span> <span class="n">vv</span></div>

<div class="viewcode-block" id="Geosoft_gdb.read_channel_va"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.read_channel_va">[docs]</a>    <span class="k">def</span> <span class="nf">read_channel_va</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read VA data from a single channel, return in a va.</span>

<span class="sd">        :param line:    line name or symbol</span>
<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :param dtype:   type wanted, default same as the channel data</span>

<span class="sd">        :returns:       va</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_dtype</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="n">va</span> <span class="o">=</span> <span class="n">gxva</span><span class="o">.</span><span class="n">GXva</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">get_chan_va</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">va</span><span class="o">.</span><span class="n">gxva</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="n">va</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span><span class="o">.</span><span class="n">unit_of_measure</span>

        <span class="k">return</span> <span class="n">va</span></div>

<div class="viewcode-block" id="Geosoft_gdb.read_channel"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.read_channel">[docs]</a>    <span class="k">def</span> <span class="nf">read_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read data from a single channel.</span>

<span class="sd">        :param line:    line name or symbol</span>
<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :param dtype:   type wanted, default same as the channel data</span>

<span class="sd">        :returns:       numpy data, fid (start, increment)</span>

<span class="sd">        For dtype=np.float, dummy values will be np.nan. For integer types dummy values will be the</span>
<span class="sd">        Geosoft dummy values.</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_vv</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">vv</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">dtype</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vv</span><span class="o">.</span><span class="n">fid</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">va</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_va</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">va</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">va</span><span class="o">.</span><span class="n">dtype</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">va</span><span class="o">.</span><span class="n">fid</span></div>

<div class="viewcode-block" id="Geosoft_gdb.read_line_vv"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.read_line_vv">[docs]</a>    <span class="k">def</span> <span class="nf">read_line_vv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">common_fid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chan_dtypes</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a line of data into VVs stored in a dictionary by channel.</span>

<span class="sd">        :param line:        line to read, string or symbol number</span>
<span class="sd">        :param channels:    list of channels, strings or symbol number.  If None, read all channels</span>
<span class="sd">        :param dtype:       numpy data type for the array, default np.float64 for multi-channel data (unless</span>
<span class="sd">                            chan_dtypes is `True`), data type for single channel data. Use &quot;&lt;Unnn&quot; for string type.</span>
<span class="sd">        :param common_fid:  `True` to resample all channels to a common fiducial</span>
<span class="sd">        :param chan_dtypes: `True` to determine dtype for each vv from channel type, default `False`</span>
<span class="sd">        :returns:           list of tuples [(channel_name, vv), ...]</span>

<span class="sd">        If a requested channel is a VA, it is with channel names &#39;name[0]&#39;, &#39;name[1]&#39;, etc.</span>

<span class="sd">        Examples:</span>

<span class="sd">        .. code::</span>

<span class="sd">            # npd - returned numpy array shape (n, number of channels)</span>
<span class="sd">            # ch  - list of returned channels names, array channels expanded to array[0], array[1], ...</span>
<span class="sd">            # fid - tuple (fidStart,fidIncrement), channels resampled as necessary</span>

<span class="sd">            data = gdb.read_line_vv(&#39;L100&#39;)                           # read all channels in line &quot;L100&quot;</span>
<span class="sd">            data = gdb.read_line_vv(681)                              # read all channels in line symbol 681</span>
<span class="sd">            data = gdb.read_line_vv(&#39;L100&#39;,&#39;X&#39;)                       # read channel &#39;X&#39; from line &#39;L100&#39;</span>
<span class="sd">            data = gdb.read_line_vv(&#39;L100&#39;,2135)                      # read channel symbol 2135 from &#39;L100&quot;</span>
<span class="sd">            data = gdb.read_line_vv(&#39;L100&#39;,channels=[&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;])    # read a list of channels to (n,3) array</span>
<span class="sd">            data = gdb.read_line_vv(&#39;L100&#39;,&#39;X&#39;,np.int32)              # read channel &#39;X&#39; into integer array</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorted_chan_list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string_chan_list</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>

        <span class="c1"># make up channel list, expanding VA channels</span>
        <span class="n">ch_names</span><span class="p">,</span> <span class="n">ch_symb</span><span class="p">,</span> <span class="n">c_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_chan_list</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">chan_dtypes</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>

        <span class="c1"># read the data into vv</span>
        <span class="n">chvv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ch_names</span><span class="p">:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">find_symb</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">)</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">chvv</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">vv</span><span class="p">))</span>

        <span class="c1"># resample?</span>
        <span class="k">if</span> <span class="n">common_fid</span><span class="p">:</span>

            <span class="c1"># determine fiducial range from data</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GS_R8MX</span>
            <span class="n">incr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GS_R8MX</span>
            <span class="n">fend</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GS_R8MN</span>

            <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">chvv</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fd</span> <span class="o">=</span> <span class="n">vv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fid</span>
                    <span class="k">if</span> <span class="n">fd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">fd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">start</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">fd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">fd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">incr</span><span class="p">:</span>
                            <span class="n">incr</span> <span class="o">=</span> <span class="n">fd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">dend</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">incr</span> <span class="o">*</span> <span class="p">(</span><span class="n">vv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">dend</span> <span class="o">&gt;</span> <span class="n">fend</span><span class="p">:</span>
                            <span class="n">fend</span> <span class="o">=</span> <span class="n">dend</span>

            <span class="k">if</span> <span class="n">fid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GS_R8MX</span><span class="p">:</span>
                    <span class="n">fid</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fid</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">incr</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GS_R8MX</span><span class="p">:</span>
                <span class="n">nvd</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nvd</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="n">fend</span> <span class="o">-</span> <span class="n">fid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">fid</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">chvv</span><span class="p">:</span>
                <span class="n">vv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">refid</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">nvd</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">chvv</span></div>

<div class="viewcode-block" id="Geosoft_gdb.scan_line_fid"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.scan_line_fid">[docs]</a>    <span class="k">def</span> <span class="nf">scan_line_fid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scan channels in a line and return the smallest common fid, line length, data width, list of channels</span>

<span class="sd">        :param line:        line to read, string or symbol number</span>
<span class="sd">        :param channels:    list of channels, strings or symbol number.  If empty, read all channels</span>
<span class="sd">        :returns:           (fid_start, fid_increment, fid_last, data_width, channel_list)</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorted_chan_list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string_chan_list</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_increment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_fid</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_channel_length</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fid_last</span> <span class="o">=</span> <span class="n">fid_start</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fid_last</span> <span class="o">=</span> <span class="n">fid_start</span> <span class="o">+</span> <span class="n">fid_increment</span> <span class="o">*</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">c</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">n_width</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="n">c_start</span><span class="p">,</span> <span class="n">c_increment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_fid</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c_start</span> <span class="o">!=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
                <span class="n">c_last</span> <span class="o">=</span> <span class="n">c_start</span> <span class="o">+</span> <span class="n">c_increment</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_channel_length</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fid_start</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span> <span class="ow">or</span> <span class="n">c_start</span> <span class="o">&lt;</span> <span class="n">fid_start</span><span class="p">:</span>
                    <span class="n">fid_start</span> <span class="o">=</span> <span class="n">c_start</span>
                <span class="k">if</span> <span class="n">fid_increment</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span> <span class="ow">or</span> <span class="n">c_increment</span> <span class="o">&lt;</span> <span class="n">fid_increment</span><span class="p">:</span>
                    <span class="n">fid_increment</span> <span class="o">=</span> <span class="n">c_increment</span>
                <span class="k">if</span> <span class="n">c_last</span> <span class="o">&gt;</span> <span class="n">fid_last</span><span class="p">:</span>
                    <span class="n">fid_last</span> <span class="o">=</span> <span class="n">c_last</span>

        <span class="k">if</span> <span class="n">fid_start</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span> <span class="ow">or</span> <span class="n">fid_increment</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">channels</span>
        <span class="k">return</span> <span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_increment</span><span class="p">,</span> <span class="n">fid_last</span><span class="p">,</span> <span class="n">n_width</span><span class="p">,</span> <span class="n">channels</span></div>

<div class="viewcode-block" id="Geosoft_gdb.readLine"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.readLine">[docs]</a>    <span class="k">def</span> <span class="nf">readLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 use read_line() </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_line</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_num_rows_from_fid</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">src_fid_start</span><span class="p">,</span> <span class="n">src_fid_last</span><span class="p">,</span> <span class="n">fid</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="n">src_fid_last</span> <span class="o">-</span> <span class="n">fid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">fid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>

<div class="viewcode-block" id="Geosoft_gdb.read_line"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.read_line">[docs]</a>    <span class="k">def</span> <span class="nf">read_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a line of data into a numpy array.</span>

<span class="sd">        :param line:        line to read, string or symbol number</span>
<span class="sd">        :param channels:    list of channels, strings or symbol number.  If empty, read all channels</span>
<span class="sd">        :param dtype:       numpy data type for the array, default np.float64 for multi-channel data,</span>
<span class="sd">                            data type for single channel data. Use &quot;&lt;Unnn&quot; for string type.</span>
<span class="sd">        :param fid:         required fiducial as tuple (start,incr), default smallest in data</span>
<span class="sd">        :param dummy:       dummy_handling for multi-channel read, default leaves dummies in place.:</span>

<span class="sd">            ======================== ===================================================</span>
<span class="sd">            READ_REMOVE_DUMMYROWS    remove rows with dummies, fiducials lose meaning</span>
<span class="sd">            READ_REMOVE_DUMMYCOLUMNS remove columns with dummies</span>
<span class="sd">            ======================== ===================================================</span>

<span class="sd">        :returns:   2D numpy array shape(records,channels), list of channel names, (fidStart,fidIncr)</span>
<span class="sd">        :raises:    GdbException if first channel requested is empty</span>

<span class="sd">        VA channels are expanded by element with channel names name[0], name[1], etc.</span>

<span class="sd">        This method is intended for relatively simple databases in relatively simple applications.</span>
<span class="sd">        If your database has a lot of channels, or wide array channels it will be more efficient</span>
<span class="sd">        to read and work with just the channels you need.  See `read_channel`, `read_channel_vv`</span>
<span class="sd">        and `read_channel_va`.</span>

<span class="sd">        Examples:</span>

<span class="sd">        .. code::</span>

<span class="sd">            # npd - returned numpy array shape (n, number of channels)</span>
<span class="sd">            # ch  - list of returned channels names, array channels expanded to array[0], array[1], ...</span>
<span class="sd">            # fid - tuple (fidStart,fidIncrement), channels resampled as necessary</span>

<span class="sd">            npd,ch,fid = gdb.read_line(&#39;L100&#39;)                           # read all channels in line &quot;L100&quot;</span>
<span class="sd">            npd,ch,fid = gdb.read_line(681)                              # read all channels in line symbol 681</span>
<span class="sd">            npd,ch,fid = gdb.read_line(&#39;L100&#39;,&#39;X&#39;)                       # read channel &#39;X&#39; from line &#39;L100&#39;</span>
<span class="sd">            npd,ch,fid = gdb.read_line(&#39;L100&#39;,2135)                      # read channel symbol 2135 from &#39;L100&quot;</span>
<span class="sd">            npd,ch,fid = gdb.read_line(&#39;L100&#39;,channels=[&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;])    # read a list of channels to (n,3) array</span>
<span class="sd">            npd,ch,fid = gdb.read_line(&#39;L100&#39;,&#39;X&#39;,np.int32)              # read channel &#39;X&#39; into integer array</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_incr</span><span class="p">,</span> <span class="n">fid_last</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_line_fid</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="p">(</span><span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_incr</span><span class="p">)</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows_from_fid</span><span class="p">(</span><span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_last</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">fid</span>

        <span class="c1"># read to a numpy array</span>
        <span class="n">npd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">npd</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span> <span class="ow">or</span> <span class="n">npd</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
            <span class="n">dummy_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dummy_value</span> <span class="o">=</span> <span class="n">gxu</span><span class="o">.</span><span class="n">gx_dummy</span><span class="p">(</span><span class="n">npd</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="n">all_empty</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ch_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">icol</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">npd</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">all_empty</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">vv</span><span class="o">.</span><span class="n">refid</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
                <span class="n">npd</span><span class="p">[:,</span> <span class="n">icol</span><span class="p">]</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">np</span>
                <span class="n">icol</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_va</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">npd</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">va</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">all_empty</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">va</span><span class="o">.</span><span class="n">refid</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
                <span class="n">npd</span><span class="p">[:,</span> <span class="n">icol</span><span class="p">:</span><span class="n">icol</span><span class="o">+</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">va</span><span class="o">.</span><span class="n">np</span>
                <span class="n">icol</span> <span class="o">+=</span> <span class="n">w</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
                    <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

        <span class="n">nch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_names</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">all_empty</span><span class="p">:</span>
            <span class="n">npd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dummy</span><span class="p">:</span>
            <span class="c1"># dummy handling</span>
            <span class="k">if</span> <span class="n">dummy</span> <span class="o">==</span> <span class="n">READ_REMOVE_DUMMYCOLUMNS</span><span class="p">:</span>
                <span class="n">n_ok</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># shift data and channel names to remove columns containing a dummy</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nch</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dummy_value</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">npd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                            <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">dummy_value</span> <span class="ow">in</span> <span class="n">npd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">n_ok</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">npd</span><span class="p">[:,</span> <span class="n">n_ok</span><span class="p">]</span> <span class="o">=</span> <span class="n">npd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
                        <span class="n">ch_names</span><span class="p">[</span><span class="n">n_ok</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">n_ok</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">n_ok</span> <span class="o">!=</span> <span class="n">nch</span><span class="p">:</span>
                    <span class="n">npd</span> <span class="o">=</span> <span class="n">npd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_ok</span><span class="p">]</span>
                    <span class="n">ch_names</span> <span class="o">=</span> <span class="n">ch_names</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_ok</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">dummy</span> <span class="o">==</span> <span class="n">READ_REMOVE_DUMMYROWS</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dummy_value</span><span class="p">):</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">npd</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dummy_value</span> <span class="ow">in</span> <span class="n">a</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">npd</span><span class="p">)</span>
                <span class="n">npd</span> <span class="o">=</span> <span class="n">npd</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">fid</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Unrecognized dummy=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dummy</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">npd</span><span class="p">,</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">fid</span></div>

<div class="viewcode-block" id="Geosoft_gdb.read_line_dataframe"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.read_line_dataframe">[docs]</a>    <span class="k">def</span> <span class="nf">read_line_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a line of data into a Pandas DataFrame</span>

<span class="sd">        :param line:        line to read, string or symbol number</span>
<span class="sd">        :param channels:    list of channels, strings or symbol number.  If empty, read all channels</span>
<span class="sd">        :param fid:         required fiducial as tuple (start,incr), default smallest in data</span>

<span class="sd">        :returns:   Pandas DataFrame, list of channel names, (fidStart,fidIncr)</span>
<span class="sd">        :raises:    GdbException if first channel requested is empty</span>

<span class="sd">        VA channels are expanded by element with channel names name[0], name[1], etc.</span>

<span class="sd">        This method can be used to conveniently get a table structure of all data corresponding to the</span>
<span class="sd">        native types of the channels. It is however not necessarily the most efficient way to get at the data.</span>
<span class="sd">        If your database has a lot of channels, or wide array channels it will be more efficient</span>
<span class="sd">        to read and work with just the channels you need.  See `read_channel`, `read_channel_vv`</span>
<span class="sd">        and `read_channel_va`. This method also does not currently support dummy removal in the same</span>
<span class="sd">        way as `read_line`.</span>

<span class="sd">        Examples:</span>

<span class="sd">        .. code::</span>

<span class="sd">            # df - Pandas DataFrame</span>
<span class="sd">            # ch  - list of returned channels names</span>
<span class="sd">            # fid - tuple (fidStart,fidIncrement), channels resampled as necessary</span>

<span class="sd">            df,ch,fid = gdb.read_line(&#39;L100&#39;)                           # read all channels in line &quot;L100&quot;</span>
<span class="sd">            df,ch,fid = gdb.read_line(681)                              # read all channels in line symbol 681</span>
<span class="sd">            df,ch,fid = gdb.read_line(&#39;L100&#39;,&#39;X&#39;)                       # read channel &#39;X&#39; from line &#39;L100&#39;</span>
<span class="sd">            df,ch,fid = gdb.read_line(&#39;L100&#39;,2135)                      # read channel symbol 2135 from &#39;L100&quot;</span>
<span class="sd">            df,ch,fid = gdb.read_line(&#39;L100&#39;,channels=[&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;])    # read a list of channels to (n,3) array</span>

<span class="sd">        .. versionadded:: 9.5</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_incr</span><span class="p">,</span> <span class="n">fid_last</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_line_fid</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="p">)</span>
        <span class="n">ch_names</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">fid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="p">(</span><span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_incr</span><span class="p">)</span>

        <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows_from_fid</span><span class="p">(</span><span class="n">fid_start</span><span class="p">,</span> <span class="n">fid_last</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
                <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
                    <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
                        <span class="n">va_cn</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                        <span class="n">df</span><span class="p">[</span><span class="n">va_cn</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
                        <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">va_cn</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">fid</span>

        <span class="n">icol</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">all_empty</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">all_empty</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">vv</span><span class="o">.</span><span class="n">refid</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
                <span class="n">df</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">np</span>
                <span class="n">icol</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_va</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">va</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">all_empty</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">va</span><span class="o">.</span><span class="n">refid</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
                <span class="n">icol</span> <span class="o">+=</span> <span class="n">w</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
                    <span class="n">va_cn</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">va_cn</span><span class="p">]</span> <span class="o">=</span> <span class="n">va</span><span class="o">.</span><span class="n">np</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
                    <span class="n">ch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">va_cn</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">all_empty</span><span class="p">:</span>
            <span class="c1"># Delete one and only row</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">fid</span></div>

<div class="viewcode-block" id="Geosoft_gdb.write_channel_vv"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.write_channel_vv">[docs]</a>    <span class="k">def</span> <span class="nf">write_channel_vv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">vv</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write data to a single channel.</span>

<span class="sd">        :param line:    line name or symbol</span>
<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :param vv:      vv data to write</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_channel</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">vv</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="n">cn</span> <span class="o">=</span> <span class="n">channel</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">if</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear_extent</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">put_chan_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">vv</span><span class="o">.</span><span class="n">gxvv</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">unit_of_measure</span><span class="p">:</span>
            <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">unit_of_measure</span></div>

<div class="viewcode-block" id="Geosoft_gdb.write_channel_va"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.write_channel_va">[docs]</a>    <span class="k">def</span> <span class="nf">write_channel_va</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">va</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write VA data to a single channel.</span>

<span class="sd">        :param line:    line name or symbol</span>
<span class="sd">        :param channel: channel name or symbol</span>
<span class="sd">        :param va:      va data to write</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_channel</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">va</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">va</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">put_chan_va</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">va</span><span class="o">.</span><span class="n">gxva</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">va</span><span class="o">.</span><span class="n">unit_of_measure</span><span class="p">:</span>
            <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">va</span><span class="o">.</span><span class="n">unit_of_measure</span></div>

<div class="viewcode-block" id="Geosoft_gdb.writeDataChan"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.writeDataChan">[docs]</a>    <span class="k">def</span> <span class="nf">writeDataChan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 9.2 use `write_channel`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_channel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.write_channel"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.write_channel">[docs]</a>    <span class="k">def</span> <span class="nf">write_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">unit_of_measure</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write data to a single channel.</span>

<span class="sd">        :param line:            line name or symbol</span>
<span class="sd">        :param channel:         channel name or symbol</span>
<span class="sd">        :param data:            numpy array (2D for VA channel), or a list</span>
<span class="sd">        :param fid:             tuple (fid start, increment), default (0.0,1.0)</span>
<span class="sd">        :param unit_of_measure: data unit of measurement</span>

<span class="sd">        .. versionchanged:: 9.3 support for setting channel from a list</span>

<span class="sd">            added unit_of_measure</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ln</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">cn</span> <span class="o">=</span> <span class="n">channel</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_channel</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">_va_width</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear_extent</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">_va_width</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># no data to write</span>
            <span class="k">return</span>

        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">w</span> <span class="o">!=</span> <span class="n">_va_width</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span>
                <span class="n">_t</span><span class="p">(</span><span class="s2">&quot;Array data width </span><span class="si">{}</span><span class="s2"> does not fit into channel &#39;</span><span class="si">{}</span><span class="s2">&#39; with width </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span>
                <span class="nb">format</span><span class="p">(</span><span class="n">_va_width</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">cn</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>

        <span class="c1"># 1D channel</span>
        <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

            <span class="c1"># get a VV of the data</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="n">gxvv</span><span class="o">.</span><span class="n">GXvv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="n">fid</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">put_chan_vv</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">vv</span><span class="o">.</span><span class="n">gxvv</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># get a VA of the data</span>
            <span class="n">va</span> <span class="o">=</span> <span class="n">gxva</span><span class="o">.</span><span class="n">GXva</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="n">fid</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">put_chan_va</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">va</span><span class="o">.</span><span class="n">gxva</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">unit_of_measure</span><span class="p">:</span>
            <span class="n">Channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">unit_of_measure</span></div>

<div class="viewcode-block" id="Geosoft_gdb.write_line_vv"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.write_line_vv">[docs]</a>    <span class="k">def</span> <span class="nf">write_line_vv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">chan_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write data to multiple channels in a line.  If no channel list is provided it assumes that the</span>
<span class="sd">        data is for all channels from the line, the compliment of read_line().</span>

<span class="sd">        :param line:        line to write to, name or symbol</span>
<span class="sd">        :param chan_data:   numpy array shape (records,channels).  If single dimension, one channel.</span>
<span class="sd">                            Channels are created if they do not exist.  VA channels must exist.</span>
<span class="sd">        :param chan_data:   list of tuples [(channel_name, vv), ]</span>

<span class="sd">        .. note::</span>

<span class="sd">            chan_data may contain VA data, which is defined by slice (ie. name[0], name[4]...).</span>
<span class="sd">            If VA data is included the VA channels must already exist.</span>

<span class="sd">        .. versionadded:: 9.2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">chvv</span> <span class="ow">in</span> <span class="n">chan_data</span><span class="p">:</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="n">chvv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="n">chvv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_channel_vv</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span></div>

<div class="viewcode-block" id="Geosoft_gdb.write_line"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.write_line">[docs]</a>    <span class="k">def</span> <span class="nf">write_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write data to a multiple channels in a line.  If no channel list is provided it assumes that the</span>
<span class="sd">        data is for all channels from the line, the compliment of read_line().</span>

<span class="sd">        :param line:        line to write to, name or symbol</span>
<span class="sd">        :param data:        numpy array shape (records,channels).  If single dimension, one channel</span>
<span class="sd">        :param channels:    channel name or symbol list, or a single name/symbol.  If a single name is specified</span>
<span class="sd">                            for multi-column data, a VA channel is assumed. If None, a sorted list of all channels</span>
<span class="sd">                            is assumed.</span>
<span class="sd">        :param fid:         option fid tuple (start, increment), default (0.0,1.0)</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_channel</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="n">fid</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorted_chan_list</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string_chan_list</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="c1"># ensure data matches channels</span>
            <span class="n">np_data</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ch</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">np_data</span> <span class="o">+=</span> <span class="n">w</span>

            <span class="c1"># channel - data mismatch</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np_data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Data dimension (</span><span class="si">{}</span><span class="s1">) does not match data required by channels (</span><span class="si">{}</span><span class="s1">).&#39;</span><span class="p">)</span><span class="o">.</span>
                                   <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">channels</span><span class="p">))</span>

            <span class="c1"># all good, write the data</span>
            <span class="n">np_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ch</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="n">chan</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_channel</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">np_index</span><span class="p">:</span> <span class="n">np_index</span> <span class="o">+</span> <span class="n">w</span><span class="p">],</span> <span class="n">fid</span><span class="o">=</span><span class="n">fid</span><span class="p">)</span>
                <span class="n">np_index</span> <span class="o">+=</span> <span class="n">w</span></div>

<div class="viewcode-block" id="Geosoft_gdb.list_values"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.list_values">[docs]</a>    <span class="k">def</span> <span class="nf">list_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chan</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">selected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dupl</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a list of unique values in a channel.  Uniqueness depends on the current display format for</span>
<span class="sd">        the field.</span>

<span class="sd">        :param chan:            channel to scan</span>
<span class="sd">        :param umax:            maximum values allowed, once this maximum is reached scanning stops, default 1000</span>
<span class="sd">        :param selected:        `True` to scan only selected lines</span>
<span class="sd">        :param dupl:            Stop growing list after this many lines fail to grow the list, 0 scans all lines</span>
<span class="sd">        :param progress:        progress reporting function</span>
<span class="sd">        :param stop:            stop check function</span>
<span class="sd">        :returns:               list of values, represented as a string</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_lines</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="n">selected</span><span class="p">))</span>
        <span class="n">cn</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
        <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_details</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;&lt;U</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">)))</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
        <span class="n">vset</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ndup</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_line</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">GdbException</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">vset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vset</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
            <span class="n">vset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">vset</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">vset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">umax</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">dupl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nset</span><span class="p">:</span>
                    <span class="n">ndup</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">ndup</span> <span class="o">&gt;</span> <span class="n">dupl</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ndup</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nset</span> <span class="o">=</span> <span class="n">vset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
                <span class="n">progress</span><span class="p">(</span><span class="s1">&#39;Scanning unique values in &quot;</span><span class="si">{}</span><span class="s1">&quot;, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)),</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">stop</span><span class="p">():</span>
                    <span class="k">return</span> <span class="n">vset</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">vset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">umax</span><span class="p">:</span>
            <span class="n">vset</span> <span class="o">=</span> <span class="n">vset</span><span class="p">[:</span><span class="n">umax</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">vset</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="Geosoft_gdb.figure_map"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Geosoft_gdb.figure_map">[docs]</a>    <span class="k">def</span> <span class="nf">figure_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">DRAW_AS_POINTS</span><span class="p">,</span>
                   <span class="n">features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a figure map file from selected lines in the database.</span>

<span class="sd">        :param file_name:       the name of the map, if None a temporary default map is created.</span>
<span class="sd">        :param overwrite:       `True` to overwrite map file should it exist</span>
<span class="sd">        :param title:           Title added to the image</span>
<span class="sd">        :param draw:            `DRAW_AS_POINTS` to draw a dot at each point (default). Long lines are decimated.</span>
<span class="sd">                                `DRAW_AS_LINES` to draw lines with a line label at each end.</span>
<span class="sd">        :param features:        list of features to place on the map, default is (&#39;SCALE&#39;, &#39;NEATLINE&#39;)</span>

<span class="sd">                                    =========== ===========================================</span>
<span class="sd">                                    &#39;ALL&#39;       include all features.  This is the default.</span>
<span class="sd">                                    &#39;SCALE&#39;     show a scale bar</span>
<span class="sd">                                    &#39;NEATLINE&#39;  draw a neat-line around the image</span>
<span class="sd">                                    &#39;ANNOT_XY&#39;  annotate map coordinates</span>
<span class="sd">                                    &#39;ANNOT_LL&#39;  annotate map Latitude, Longitude</span>
<span class="sd">                                    =========== ===========================================</span>

<span class="sd">        :param kwargs:          passed to `geosoft.gxpy.map.Map.new`</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># uppercase features, use a dict so we pop things we use and report error</span>
        <span class="k">if</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ALL&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">features</span> <span class="o">=</span> <span class="p">(</span><span class="n">features</span><span class="p">,)</span>
        <span class="n">feature_list</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
                <span class="n">feature_list</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">feature_list</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># setup margins</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s1">&#39;margins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>

            <span class="n">bottom_margin</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
                <span class="n">bottom_margin</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.0</span>
            <span class="k">if</span> <span class="s1">&#39;ALL&#39;</span> <span class="ow">in</span> <span class="n">feature_list</span> <span class="ow">or</span> <span class="s1">&#39;SCALE&#39;</span> <span class="ow">in</span> <span class="n">feature_list</span><span class="p">:</span>
                <span class="n">bottom_margin</span> <span class="o">+=</span> <span class="mf">1.2</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;margins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bottom_margin</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;coordinate_system&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span>

        <span class="c1"># work out some non-zero extents</span>
        <span class="n">ex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extent_xyz</span>
        <span class="k">if</span> <span class="n">ex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ex</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ex</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Invalid data extent: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>

        <span class="n">mnx</span><span class="p">,</span> <span class="n">mny</span><span class="p">,</span> <span class="n">mxx</span><span class="p">,</span> <span class="n">mxy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ex</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ex</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">mxx</span> <span class="o">-</span> <span class="n">mnx</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">mxy</span> <span class="o">-</span> <span class="n">mny</span>
        <span class="k">if</span> <span class="n">dx</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dy</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="p">(</span><span class="n">mnx</span> <span class="o">-</span> <span class="mf">50.</span><span class="p">,</span> <span class="n">mny</span> <span class="o">-</span> <span class="mf">50.</span><span class="p">,</span> <span class="n">mxx</span> <span class="o">+</span> <span class="mf">50.</span><span class="p">,</span> <span class="n">mxy</span> <span class="o">+</span> <span class="mf">50.</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dx</span> <span class="o">&lt;</span> <span class="n">dy</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">*</span> <span class="mf">0.05</span>
                <span class="n">mnx</span> <span class="o">-=</span> <span class="n">d</span>
                <span class="n">mxx</span> <span class="o">+=</span> <span class="n">d</span>
            <span class="k">elif</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="n">dx</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="mf">0.05</span>
                <span class="n">mny</span> <span class="o">-=</span> <span class="n">d</span>
                <span class="n">mxy</span> <span class="o">+=</span> <span class="n">d</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="p">(</span><span class="n">mnx</span><span class="p">,</span> <span class="n">mny</span><span class="p">,</span> <span class="n">mxx</span><span class="p">,</span> <span class="n">mxy</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;inside_margin&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;inside_margin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">gmap</span> <span class="o">=</span> <span class="n">gxmap</span><span class="o">.</span><span class="n">Map</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span>
                                <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                                <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                                <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
                                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_channels</span>
        <span class="k">with</span> <span class="n">gxview</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">gmap</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">gxgroup</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;lines&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_lines</span><span class="p">():</span>
                    <span class="n">xvv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_vv</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                    <span class="n">yvv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_channel_vv</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">draw</span> <span class="o">==</span> <span class="n">DRAW_AS_LINES</span><span class="p">:</span>
                        <span class="n">g</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="n">gxgeo</span><span class="o">.</span><span class="n">PPoint</span><span class="p">((</span><span class="n">xvv</span><span class="p">,</span> <span class="n">yvv</span><span class="p">)),</span>
                                   <span class="n">pen</span><span class="o">=</span><span class="n">gxgroup</span><span class="o">.</span><span class="n">Pen</span><span class="p">(</span><span class="n">line_thick</span><span class="o">=</span><span class="mf">0.03</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">units_per_map_cm</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">g</span><span class="o">.</span><span class="n">polypoint</span><span class="p">(</span><span class="n">gxgeo</span><span class="o">.</span><span class="n">PPoint</span><span class="p">((</span><span class="n">xvv</span><span class="p">,</span> <span class="n">yvv</span><span class="p">)),</span>
                                    <span class="n">pen</span><span class="o">=</span><span class="n">gxgroup</span><span class="o">.</span><span class="n">Pen</span><span class="p">(</span><span class="n">line_thick</span><span class="o">=</span><span class="mf">0.03</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">units_per_map_cm</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">gmap</span></div></div>


<div class="viewcode-block" id="Channel"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Channel">[docs]</a><span class="k">class</span> <span class="nc">Channel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to work with database channels.  Use constructor `Channel.new` to create a new channel.</span>
<span class="sd">    Use instance properties to work with channel properties.</span>

<span class="sd">    :param gdb:     database instance</span>
<span class="sd">    :param name:    channel name string, must exist - see `new()` to create a new channel</span>

<span class="sd">    .. versionadded:: 9.3</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
            <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

<div class="viewcode-block" id="Channel.lock_set_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Channel.lock_set_">[docs]</a>    <span class="k">def</span> <span class="nf">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<div class="viewcode-block" id="Channel.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Channel.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdb</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span> <span class="o">=</span> <span class="n">gdb</span>
        <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Channel.new"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Channel.new">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">gdb</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unit_of_measure</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new channel.</span>

<span class="sd">        :param gdb:             Geosoft_gdb instance</span>
<span class="sd">        :param name:            channel name</span>
<span class="sd">        :param dtype:           numpy data type, defaule np.float64</span>
<span class="sd">        :param array:           array size, default 1</span>
<span class="sd">        :param dup:             duplicate properties of this channal (name, symbol or Channel)</span>
<span class="sd">        :param details:         dictionary of other channel properties - see `Geosoft_gdb.set_channel_details`</span>
<span class="sd">        :param replace:         `True` to replace existing channel.  Existing channel information and data is lost.</span>
<span class="sd">                                default is `False`.</span>
<span class="sd">        :param unit_of_measure: unit of measurement of the data</span>
<span class="sd">        :return:        Channel instance</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">gdb</span><span class="o">.</span><span class="n">exist_symb_</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">replace</span><span class="p">:</span>
                <span class="n">gdb</span><span class="o">.</span><span class="n">delete_channel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s2">&quot;Cannot replace existing channel &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>
        <span class="n">symb</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">new_channel</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">array</span><span class="p">,</span> <span class="n">dup</span><span class="o">=</span><span class="n">dup</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="n">gdb</span><span class="o">.</span><span class="n">set_channel_details</span><span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>

        <span class="n">chan</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">gdb</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unit_of_measure</span><span class="p">:</span>
            <span class="n">chan</span><span class="o">.</span><span class="n">unit_of_measure</span> <span class="o">=</span> <span class="n">unit_of_measure</span>

        <span class="k">return</span> <span class="n">chan</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Channel name.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_name</span><span class="p">)</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">is_chan_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Invalid channel name </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">exist_symb_</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_CHAN</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Cannot rename to an existing channel name </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Channel symbol</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array channel width, 1 for non-array channels</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">channel_width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `True` if this is an array channel</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of displayed decimal places, can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="nd">@decimal</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_decimal</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Channel display format:</span>

<span class="sd">        ============= ========================================</span>
<span class="sd">        FORMAT_NORMAL normal decimal or integer format</span>
<span class="sd">        FORMAT_EXP    exponential</span>
<span class="sd">        FORMAT_TIME   geosoft time (HH:MM:SS.ssss)</span>
<span class="sd">        FORMAT_DATE   date (YYYY/MM/DD)</span>
<span class="sd">        FORMAT_GEOGR  geographic (deg.mm.ss.ssss)</span>
<span class="sd">        FORMAT_SIGDIG decimals is number of significant digits</span>
<span class="sd">        FORMAT_HEX    hexadecimal</span>
<span class="sd">        ============= ========================================</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="nd">@format</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_format</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Channel label used in display graphics, normally the same as the channel name.</span>
<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@label</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_label</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Geosoft data type.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unit_of_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unit of measure, can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@unit_of_measure</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">unit_of_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_unit</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display window width in characters.</span>
<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="nd">@width</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_width</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">class_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class name to which this channel is associated.</span>
<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@class_</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">class_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_class</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">protect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `True` if this channel is protected from modification.</span>
<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_chan_protect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">))</span>

    <span class="nd">@protect</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">protect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_chan_protect</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">locked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if symbol is locked.  Use property :any:`lock` to determine if read or write lock, or to</span>
<span class="sd">        set the lock.</span>

<span class="sd">        Setting to `False` unlocks the symbol.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">!=</span> <span class="n">SYMBOL_LOCK_NONE</span>

    <span class="nd">@locked</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">locked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Use property </span><span class="se">\&#39;</span><span class="s1">lock</span><span class="se">\&#39;</span><span class="s1"> to set SYMBOL_READ or SYMBOL_WRITE lock.&#39;</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lock setting:</span>

<span class="sd">        | -1 unlocked (SYMBOL_LOCK_NONE)</span>
<span class="sd">        | 0 read-locked (SYMBOL_LOCK_READ)</span>
<span class="sd">        | 1 write-locked (SYMBOL_LOCK_WRITE)</span>

<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_symb_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

    <span class="nd">@lock</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">lock_symb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_WAIT_INFINITY</span><span class="p">)</span>

<div class="viewcode-block" id="Channel.delete"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Channel.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the channel and all associated data.  After calling this method this</span>
<span class="sd">        channel instance is no longer valid.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protect</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s2">&quot;Cannot delete protected channel &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">SYMBOL_LOCK_WRITE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">delete_symb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">NULLSYMB</span></div></div>


<div class="viewcode-block" id="Line"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line">[docs]</a><span class="k">class</span> <span class="nc">Line</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to work with database lines.  Use constructor `Line.new` to create a new line.</span>
<span class="sd">    Use instance properties to work with line properties.</span>

<span class="sd">    :param gdb:     `Geosoft_gdb` instance</span>
<span class="sd">    :param name:    line name string, must exist - see `new()` to create a new line</span>

<span class="sd">    .. versionadded:: 9.3</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sr</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">str_ref</span><span class="p">()</span>
            <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">value</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>

<div class="viewcode-block" id="Line.lock_set_"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line.lock_set_">[docs]</a>    <span class="k">def</span> <span class="nf">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;write_lock, set and release a gdb attribute that requires locking to write.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_write_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<div class="viewcode-block" id="Line.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdb</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span> <span class="o">=</span> <span class="n">gdb</span>
        <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">line_name_symb</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Line.new"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line.new">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">gdb</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new line.</span>

<span class="sd">        :param gdb:         `Geosoft_gdb` instance</span>
<span class="sd">        :param name:        line name</span>
<span class="sd">        :param linetype:    line type for creating a new line, ignored if group defines</span>

<span class="sd">            ================= =========================================</span>
<span class="sd">            SYMB_LINE_NORMAL  normal lines, name is a string</span>
<span class="sd">            SYMB_LINE_FLIGHT  flight lines, first letter is line type</span>
<span class="sd">            ================= =========================================</span>

<span class="sd">        :param group:       group name for a grouped class</span>
<span class="sd">        :param dup:         duplicate properties of this line (name, symbol or Line).</span>
<span class="sd">        :param replace:     `True` to replace line if it exists. Default is `False` .</span>
<span class="sd">        :returns:           Line instance</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dup</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_valid_line_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Invalid line name: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">gdb</span><span class="o">.</span><span class="n">exist_symb_</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_SYMB_LINE</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">replace</span><span class="p">:</span>
                <span class="n">gdb</span><span class="o">.</span><span class="n">delete_line</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s2">&quot;Cannot replace existing line &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>

        <span class="n">gdb</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">linetype</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">dup</span><span class="o">=</span><span class="n">dup</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">gdb</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line name, consistent with names constructed by `create_line_name`.</span>

<span class="sd">        To change a line name change the type, number or version.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_symb_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line symbol</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line type, which can be set:</span>

<span class="sd">        | LINE_TYPE_NORMAL</span>
<span class="sd">        | LINE_TYPE_BASE</span>
<span class="sd">        | LINE_TYPE_TIE</span>
<span class="sd">        | LINE_TYPE_TEST</span>
<span class="sd">        | LINE_TYPE_TREND</span>
<span class="sd">        | LINE_TYPE_SPECIAL</span>
<span class="sd">        | LINE_TYPE_RANDOM</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">line_type</span><span class="p">)</span>

    <span class="nd">@type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_type</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line category, which can be set:</span>

<span class="sd">        | LINE_CATAGORY_FLIGHT</span>
<span class="sd">        | LINE_CATEGORY_GROUP</span>
<span class="sd">        | LINE_CATEGORY_NORMAL</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">line_category</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line date. Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">line_date</span><span class="p">)</span>

    <span class="nd">@date</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_date</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line flight number (flight/cruise/survey event). Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">line_flight</span><span class="p">)</span>
    
    <span class="nd">@flight</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_flight</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line number. Can be set</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">line_number</span><span class="p">)</span>

    <span class="nd">@number</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_num</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Line version number. Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">line_version</span><span class="p">)</span>

    <span class="nd">@version</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_ver</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">grouped</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if this is a grouped line.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="n">LINE_CATEGORY_GROUP</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The lines group class name, &#39;&#39; for a group lines (LINE_CATEGORY_GROUP).</span>
<span class="sd">        Only works for lines that are part of a group.</span>
<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="n">LINE_CATEGORY_GROUP</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_group_class</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@group</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="n">LINE_CATEGORY_GROUP</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_group_class</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Line </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> is not a grouped line.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if this line is selected, can be set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_line_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_INCLUDE</span>

    <span class="nd">@selected</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_INCLUDE</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_LINE_SELECT_EXCLUDE</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">locked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if symbol is locked.  Use property :any:`lock` to determine if read or write lock, or to</span>
<span class="sd">        set the lock.</span>

<span class="sd">        Setting to `False` unlocks the symbol.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">!=</span> <span class="n">SYMBOL_LOCK_NONE</span>

    <span class="nd">@locked</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">locked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GdbException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Use property </span><span class="se">\&#39;</span><span class="s1">lock</span><span class="se">\&#39;</span><span class="s1"> to set SYMBOL_READ or SYMBOL_WRITE lock.&#39;</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lock setting:</span>

<span class="sd">        | -1 unlocked (SYMBOL_LOCK_NONE)</span>
<span class="sd">        | 0 read-locked (SYMBOL_LOCK_READ)</span>
<span class="sd">        | 1 write-locked (SYMBOL_LOCK_WRITE)</span>

<span class="sd">        Can be set.</span>

<span class="sd">        .. versionadded 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">get_symb_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

    <span class="nd">@lock</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">lock_symb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">DB_WAIT_INFINITY</span><span class="p">)</span>

<div class="viewcode-block" id="Line.delete"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the line and all data associated with the line.  After calling this method this</span>
<span class="sd">        line instance is no longer valid.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">delete_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">NULLSYMB</span></div>

<div class="viewcode-block" id="Line.delete_data"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line.delete_data">[docs]</a>    <span class="k">def</span> <span class="nf">delete_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all data in a line but keep the line</span>

<span class="sd">        .. versionadded:: 9.6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">delete_line_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span></div>

    <span class="c1"># =================================</span>
    <span class="c1"># methods that work with line data</span>

<div class="viewcode-block" id="Line.bearing"><a class="viewcode-back" href="../../../geosoft.gxpy.gdb.html#geosoft.gxpy.gdb.Line.bearing">[docs]</a>    <span class="k">def</span> <span class="nf">bearing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return bearing of a line based on location of the first and last point in the line.</span>
<span class="sd">        Returns None if the line is empty or first and last points are the same.</span>

<span class="sd">        .. versionadded:: 9.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">xyz_channels</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">channel_name_symb</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">lock_read_</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bearing</span> <span class="o">=</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">GXDU</span><span class="o">.</span><span class="n">direction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symb</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">unlock_</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lock_set_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdb</span><span class="o">.</span><span class="n">gxdb</span><span class="o">.</span><span class="n">set_line_bearing</span><span class="p">,</span> <span class="n">bearing</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bearing</span> <span class="o">==</span> <span class="n">gxapi</span><span class="o">.</span><span class="n">rDUMMY</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">bearing</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Geosoft GX Python API 2022.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geosoft.gxpy.gdb</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Geosoft Inc.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>