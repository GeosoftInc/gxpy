

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>geosoft.gxpy.dap_client &#8212; Geosoft GX Python API 9.10.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/maki.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-87443115-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Geosoft GX Python API 9.10.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geosoft.gxpy.dap_client</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Introduction</a></li>
    <li><a href="../../index.html">Module code</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geosoft.gxpy.dap_client</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Geosoft dap server handling.</span>

<span class="sd">:Classes:</span>

<span class="sd">    ======================= ===============================================================</span>
<span class="sd">    `DapClient`             Geosoft dap client</span>
<span class="sd">    `DataType`              data type</span>
<span class="sd">    `GridExtractFormat`     return format for extracting a grid</span>
<span class="sd">    `ExtractProgressStatus` progress</span>
<span class="sd">    `DataExtract`           data extraction</span>
<span class="sd">    `BoundingBox`           bounding box</span>
<span class="sd">    `DataCard`              data information</span>
<span class="sd">    `SearchFilter`          search filter</span>
<span class="sd">    `ResultFilter`          result filter</span>
<span class="sd">    `SearchParameters`      search parameters</span>
<span class="sd">    ======================= ===============================================================</span>

<span class="sd">    Regression tests provide usage examples:     </span>
<span class="sd">    `Tests &lt;https://github.com/GeosoftInc/gxpy/blob/master/geosoft/gxpy/tests/test_dap.py&gt;`_</span>

<span class="sd">.. versionadded:: 9.4</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">get</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">exceptions</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>

<span class="kn">import</span> <span class="nn">geosoft</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">gx</span> <span class="k">as</span> <span class="n">gx</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">coordinate_system</span> <span class="k">as</span> <span class="n">gxcs</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">geometry</span> <span class="k">as</span> <span class="n">gxgeo</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">system</span> <span class="k">as</span> <span class="n">gxsys</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utility</span> <span class="k">as</span> <span class="n">gxu</span>


<span class="n">__version__</span> <span class="o">=</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">__version__</span>

<span class="k">def</span> <span class="nf">_t</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">geosoft</span><span class="o">.</span><span class="n">gxpy</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_json_default</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span>


<span class="k">def</span> <span class="nf">_decode_object</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="c1"># print(str(o))</span>
    <span class="k">if</span> <span class="s1">&#39;CoordinateSystem&#39;</span> <span class="ow">in</span> <span class="n">o</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">BoundingBox</span><span class="p">(</span><span class="n">coordinate_system</span><span class="o">=</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;CoordinateSystem&#39;</span><span class="p">])</span>
        <span class="n">b</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">b</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">DataCard</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">Type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>


<div class="viewcode-block" id="DapClientException"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClientException">[docs]</a><span class="k">class</span> <span class="nc">DapClientException</span><span class="p">(</span><span class="n">geosoft</span><span class="o">.</span><span class="n">GXRuntimeError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exceptions from `geosoft.gxpy.dap`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DataType"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataType">[docs]</a><span class="k">class</span> <span class="nc">DataType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Supported data types&quot;&quot;&quot;</span>
    <span class="n">Map</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Grid</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Picture</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">Point</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">Database</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">Document</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">SPF</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">Generic</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">Voxel</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">ArcGIS</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">ImageServer</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">PictureSection</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">GridSection</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">ProjectZip</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">Drillhole</span> <span class="o">=</span> <span class="mi">14</span>
    <span class="n">NoData</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">ThreeDV</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">Geostring</span> <span class="o">=</span> <span class="mi">17</span>
    <span class="n">GMSYS3D</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">VOXI</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="n">PDF</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">Geosurface</span> <span class="o">=</span> <span class="mi">21</span>
    <span class="n">GMSYS2D</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="n">VectorVoxel</span> <span class="o">=</span> <span class="mi">23</span>
    <span class="n">GeosoftOffline</span> <span class="o">=</span> <span class="mi">24</span>

<div class="viewcode-block" id="DataType.datatype_default_extension"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataType.datatype_default_extension">[docs]</a>    <span class="k">def</span> <span class="nf">datatype_default_extension</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">DataType</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">ext_list</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">,</span>  <span class="c1"># 0</span>
                    <span class="s1">&#39;grd&#39;</span><span class="p">,</span>  <span class="c1"># 1</span>
                    <span class="s1">&#39;png&#39;</span><span class="p">,</span>  <span class="c1"># 2</span>
                    <span class="s1">&#39;csv&#39;</span><span class="p">,</span>  <span class="c1"># 3</span>
                    <span class="s1">&#39;gdb&#39;</span><span class="p">,</span>  <span class="c1"># 4</span>
                    <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>  <span class="c1"># 5</span>
                    <span class="s1">&#39;spf&#39;</span><span class="p">,</span>  <span class="c1"># 6</span>
                    <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>  <span class="c1"># 7</span>
                    <span class="s1">&#39;geosoft_voxel&#39;</span><span class="p">,</span>  <span class="c1"># 8</span>
                    <span class="s1">&#39;ArcGIS&#39;</span><span class="p">,</span>  <span class="c1"># 9</span>
                    <span class="s1">&#39;png&#39;</span><span class="p">,</span>  <span class="c1"># 10</span>
                    <span class="s1">&#39;png&#39;</span><span class="p">,</span>  <span class="c1"># 11</span>
                    <span class="s1">&#39;grd&#39;</span><span class="p">,</span>  <span class="c1"># 12</span>
                    <span class="s1">&#39;zip&#39;</span><span class="p">,</span>  <span class="c1"># 13</span>
                    <span class="s1">&#39;zip&#39;</span><span class="p">,</span>  <span class="c1"># 14</span>
                    <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>  <span class="c1"># 15</span>
                    <span class="s1">&#39;3dv&#39;</span><span class="p">,</span>  <span class="c1"># 16</span>
                    <span class="s1">&#39;geosoft_geostring&#39;</span><span class="p">,</span>  <span class="c1"># 17</span>
                    <span class="s1">&#39;GMSYS3D&#39;</span><span class="p">,</span>  <span class="c1"># 18</span>
                    <span class="s1">&#39;geosoft_voxi&#39;</span><span class="p">,</span>  <span class="c1"># 19</span>
                    <span class="s1">&#39;pdf&#39;</span><span class="p">,</span>  <span class="c1"># 20</span>
                    <span class="s1">&#39;geosoft_geosurface&#39;</span><span class="p">,</span>  <span class="c1"># 21</span>
                    <span class="s1">&#39;GMSYS2D&#39;</span><span class="p">,</span>  <span class="c1"># 22</span>
                    <span class="s1">&#39;geosoft_vector_voxel&#39;</span><span class="p">,</span>  <span class="c1"># 23</span>
                    <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>  <span class="c1"># 24</span>
        <span class="k">return</span> <span class="n">ext_list</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataType.extract_url"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataType.extract_url">[docs]</a>    <span class="k">def</span> <span class="nf">extract_url</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">DataType</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;dataset/extract/&#39;</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span></div></div>


<div class="viewcode-block" id="GridExtractFormat"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.GridExtractFormat">[docs]</a><span class="k">class</span> <span class="nc">GridExtractFormat</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">GeosoftCompressed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">GeosoftUncompressed</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ESRIBinaryRaster</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">BIL</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">Geopak</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">GXFText</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">GXFCompressed</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">ODDFPC</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">ODDFUnix</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">SurferV6</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">SurferV7</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">USGSPC</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">USGSUnix</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">ERMapper</span> <span class="o">=</span> <span class="mi">13</span></div>


<div class="viewcode-block" id="ExtractProgressStatus"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.ExtractProgressStatus">[docs]</a><span class="k">class</span> <span class="nc">ExtractProgressStatus</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
   <span class="n">Prepare</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">Extract</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="n">Compress</span> <span class="o">=</span> <span class="mi">2</span>
   <span class="n">Complete</span> <span class="o">=</span> <span class="mi">3</span>
   <span class="n">Cancelled</span> <span class="o">=</span> <span class="mi">4</span>
   <span class="n">Failed</span> <span class="o">=</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="DataExtract"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataExtract">[docs]</a><span class="k">class</span> <span class="nc">DataExtract</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Data extraction instance.</span>

<span class="sd">    :param filename:    name of the data file</span>
<span class="sd">    :param extents:     data extent as a `BoundingBox` or `geosoft.gxpy.geopmetry.Point2` instance</span>
<span class="sd">    :param resolution:  desired resolution in the distance units of the extents coordinate system</span>
<span class="sd">    :param format:      one of the extraction formats for the data type, default is the first format.</span>

<span class="sd">    .. versionadded:: 9.4</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataExtract.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataExtract.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">extents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">extents</span> <span class="o">=</span> <span class="n">BoundingBox</span><span class="p">(</span><span class="n">extents</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BoundingBox</span> <span class="o">=</span> <span class="n">extents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Resolution</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Format</span> <span class="o">=</span> <span class="nb">format</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Resolution: </span><span class="si">%s</span><span class="s1">, Format: </span><span class="si">%s</span><span class="s1">, Extents: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Resolution</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundingBox</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;DataExtract(extents=</span><span class="si">%r</span><span class="s1">,filename=</span><span class="si">%r</span><span class="s1">,resolution=</span><span class="si">%r</span><span class="s1">,format=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BoundingBox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Resolution</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Format</span><span class="p">)</span></div>


<div class="viewcode-block" id="BoundingBox"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.BoundingBox">[docs]</a><span class="k">class</span> <span class="nc">BoundingBox</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bounding box instance.</span>

<span class="sd">    :param minx:                `MinX`</span>
<span class="sd">    :param miny:                `MinY`</span>
<span class="sd">    :param minz:                `MinZ`</span>
<span class="sd">    :param maxx:                `MaxX`</span>
<span class="sd">    :param maxy:                `MaxY`</span>
<span class="sd">    :param maxz:                `MaxZ`</span>
<span class="sd">    :param coordinate_system:   `CoordinateSystem`</span>
<span class="sd">                                any supported coordinate system representation. Default is &quot;WGS 84&quot;.</span>
<span class="sd">    :param cs_as_xml:           True to force the coordinate_system to be xml.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BoundingBox.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.BoundingBox.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minx</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">miny</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">minz</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxx</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">maxy</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">maxz</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">coordinate_system</span><span class="o">=</span><span class="s2">&quot;WGS 84&quot;</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span> <span class="n">BoundingBox</span><span class="p">):</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="n">minx</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinX</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">MinX</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinY</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">MinY</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinZ</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">MinZ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MaxX</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">MaxX</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MaxY</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">MaxY</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MaxZ</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">MaxZ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CoordinateSystem</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">CoordinateSystem</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MinX</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">minx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MinY</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">miny</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MinZ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">minz</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MaxX</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">maxx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MaxY</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">maxy</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MaxZ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">maxz</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CoordinateSystem</span> <span class="o">=</span> <span class="n">gxcs</span><span class="o">.</span><span class="n">Coordinate_system</span><span class="p">(</span><span class="n">coordinate_system</span><span class="p">)</span><span class="o">.</span><span class="n">xml</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="n">minx</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">gxgeo</span><span class="o">.</span><span class="n">Point2</span><span class="p">):</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="n">gxgeo</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">coordinate_system</span><span class="o">=</span><span class="n">coordinate_system</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MinX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxZ</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">extent_xyz</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CoordinateSystem</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">coordinate_system</span><span class="o">.</span><span class="n">xml</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">] - [</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">], </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MinX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoordinateSystem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;BoundingBox(minx=</span><span class="si">%r</span><span class="s1">,miny=</span><span class="si">%r</span><span class="s1">,minz=</span><span class="si">%r</span><span class="s1">,maxx=</span><span class="si">%r</span><span class="s1">,maxy=</span><span class="si">%r</span><span class="s1">,maxz=</span><span class="si">%r</span><span class="s1">,coordinate_system=</span><span class="si">%r</span><span class="s1">)&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MinX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoordinateSystem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span></div>


<div class="viewcode-block" id="DataCard"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataCard">[docs]</a><span class="k">class</span> <span class="nc">DataCard</span><span class="p">(</span><span class="n">gxgeo</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single dataset information instance.</span>

<span class="sd">    :param dap:             `DapClient` instance</span>
<span class="sd">    :param id:              `Id` unique dataset identifier property</span>
<span class="sd">    :param title:           `Title` property</span>
<span class="sd">    :param type:            `Type` dataset type, one of `DataType` values.</span>
<span class="sd">    :param hierarchy:       `Hierarchy` location in the catalog hierarchy</span>
<span class="sd">    :param stylesheet:      `Stylesheet` metadata style sheet</span>
<span class="sd">    :param extents:         `Extents` is a `BoundingBox` instance</span>
<span class="sd">    :param has_original:    `HasOriginal` True if the original data is available</span>

<span class="sd">    .. versionadded:: 9.4</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataCard.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DataCard.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hierarchy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stylesheet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">has_original</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span> <span class="o">=</span> <span class="n">dap</span>

        <span class="k">if</span> <span class="n">extents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extents</span> <span class="o">=</span> <span class="n">BoundingBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hierarchy</span> <span class="o">=</span> <span class="n">hierarchy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stylesheet</span> <span class="o">=</span> <span class="n">stylesheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Extents</span> <span class="o">=</span> <span class="n">extents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HasOriginal</span> <span class="o">=</span> <span class="n">has_original</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">title</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;Id: </span><span class="si">%s</span><span class="s1">, Title: </span><span class="si">%s</span><span class="s1">, Type: </span><span class="si">%s</span><span class="s1">, Hierarchy: </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hierarchy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;Dataset(id=</span><span class="si">%r</span><span class="s1">, title=</span><span class="si">%r</span><span class="s1">, type=</span><span class="si">%r</span><span class="s1">, hierarchy=</span><span class="si">%r</span><span class="s1">, stylesheet=</span><span class="si">%r</span><span class="s1">, has_original=</span><span class="si">%r</span><span class="s1">)&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hierarchy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Stylesheet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HasOriginal</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dap_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `DapClient` instance for this dataset, may be None if card is not yet associated with a server.</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span>

    <span class="nd">@dap_client</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dap_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dap</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span> <span class="o">=</span> <span class="n">dap</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatial_properties</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;NativeMinX&#39;</span><span class="p">],</span> <span class="n">sp</span><span class="p">[</span><span class="s1">&#39;NativeMinY&#39;</span><span class="p">],</span> <span class="n">sp</span><span class="p">[</span><span class="s1">&#39;NativeMinZ&#39;</span><span class="p">])</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;NativeMaxX&#39;</span><span class="p">],</span> <span class="n">sp</span><span class="p">[</span><span class="s1">&#39;NativeMaxY&#39;</span><span class="p">],</span> <span class="n">sp</span><span class="p">[</span><span class="s1">&#39;NativeMaxZ&#39;</span><span class="p">])</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">gxcs</span><span class="o">.</span><span class="n">Coordinate_system</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;CoordinateSystem&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="o">=</span> <span class="n">gxgeo</span><span class="o">.</span><span class="n">Point2</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">coordinate_system</span><span class="o">=</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dataset info: http://dap.geosoft.com/REST/dataset/help/operations/GetDatasetById</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;dataset/info/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">edition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edition: http://dap.geosoft.com/REST/dataset/help/operations/GetEdition</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/edition/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">disclaimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Disclaimer: http://dap.geosoft.com/REST/dataset/help/operations/GetDisclaimer</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/disclaimer/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">permission</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Permission: http://dap.geosoft.com/REST/dataset/help/operations/GetPermission</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/permission/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Metadata: http://dap.geosoft.com/REST/dataset/help/operations/GetMetadata</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/metadata/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">grid_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Grid data properties, `None` if not a grid dataset.</span>

<span class="sd">        http://dap.geosoft.com/REST/dataset/help/operations/GetGridProperties</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">Grid</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/properties/grid/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">document_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Properties of the dataset as a document.</span>

<span class="sd">        http://dap.geosoft.com/REST/dataset/help/operations/GetDocumentProperties</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/properties/document/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">point_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Point properties, `None` if not a point (hxyz) dataset.</span>

<span class="sd">        http://dap.geosoft.com/REST/dataset/help/operations/GetHXYZProperties</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">Point</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/properties/hxyz/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">map_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Map properties, `None` if not a map.</span>

<span class="sd">        http://dap.geosoft.com/REST/dataset/help/operations/GetMapProperties</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">Map</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/properties/map/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">voxel_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Voxel properties, `None` if not a voxel.</span>

<span class="sd">        http://dap.geosoft.com/REST/dataset/help/operations/GetVoxelProperties</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">Voxel</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">VectorVoxel</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/properties/voxel/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">spatial_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spatial properties: http://dap.geosoft.com/REST/dataset/help/operations/GetProperties</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataset/properties/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Id</span><span class="p">))</span></div>


<div class="viewcode-block" id="SearchFilter"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.SearchFilter">[docs]</a><span class="k">class</span> <span class="nc">SearchFilter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search filter instance.</span>

<span class="sd">    :param free_text_query:             title/keyword search filter</span>
<span class="sd">    :param structured_metadata_query:</span>
<span class="sd">    :param extents:                     `BoundingBox` instance</span>
<span class="sd">    :param entirely_within:             `True` for completely enclosed data, `False` for intersecting data.</span>
<span class="sd">    :param version:                     minimum version, default is 1.</span>

<span class="sd">    .. versionadded:: 9.4</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SearchFilter.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.SearchFilter.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">free_text_query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">structured_metadata_query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">entirely_within</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">extents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extents</span> <span class="o">=</span> <span class="n">BoundingBox</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">FreeTextQuery</span> <span class="o">=</span> <span class="n">free_text_query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StructuredMetadataQuery</span> <span class="o">=</span> <span class="n">structured_metadata_query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BoundingBox</span> <span class="o">=</span> <span class="n">extents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EntirelyWithin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">entirely_within</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RequestVersion</span> <span class="o">=</span> <span class="n">version</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;FreeTextQuery: </span><span class="si">%s</span><span class="s1">, StructuredMetadataQuery: </span><span class="si">%s</span><span class="s1">, EntirelyWithin: </span><span class="si">%s</span><span class="s1">, Extents: </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FreeTextQuery</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">StructuredMetadataQuery</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">EntirelyWithin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundingBox</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;SearchFilter(free_text_query=</span><span class="si">%r</span><span class="s1">,structured_metadata_query=</span><span class="si">%r</span><span class="s1">,extents=</span><span class="si">%r</span><span class="s1">,entirely_within=</span><span class="si">%r</span><span class="s1">,version=</span><span class="si">%r</span><span class="s1">)&#39;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FreeTextQuery</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">StructuredMetadataQuery</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">BoundingBox</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">EntirelyWithin</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">RequestVersion</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span></div>


<div class="viewcode-block" id="ResultFilter"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.ResultFilter">[docs]</a><span class="k">class</span> <span class="nc">ResultFilter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Results filter instance.</span>

<span class="sd">    :param path:            to this location in the hierarchy</span>
<span class="sd">    :param depth:           to this depth in the hierarchy, default no depth limit</span>
<span class="sd">    :param start_index:     start index in the list</span>
<span class="sd">    :param max_results:     maximum results to include</span>

<span class="sd">    .. versionadded:: 9.4</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ResultFilter.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.ResultFilter.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">2147483647</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">valid_path</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Depth</span> <span class="o">=</span> <span class="n">depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StartIndex</span> <span class="o">=</span> <span class="n">start_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaxResults</span> <span class="o">=</span> <span class="n">max_results</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ValidPath</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ValidPath</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Path: </span><span class="si">%s</span><span class="s1">, Depth: </span><span class="si">%s</span><span class="s1">, StartIndex: </span><span class="si">%s</span><span class="s1">, MaxResults: </span><span class="si">%s</span><span class="s1">, ValidPath: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartIndex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxResults</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidPath</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;ResultFilter(path=</span><span class="si">%r</span><span class="s1">,depth=</span><span class="si">%r</span><span class="s1">,start_index=</span><span class="si">%r</span><span class="s1">,max_results=</span><span class="si">%r</span><span class="s1">,valid_path=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartIndex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxResults</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidPath</span><span class="p">)</span></div>


<div class="viewcode-block" id="SearchParameters"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.SearchParameters">[docs]</a><span class="k">class</span> <span class="nc">SearchParameters</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search parameter instance, defined by a `SearchFilter` and a `ResultFilter`</span>

<span class="sd">    :param search_filter:   `SearchFilter` instance</span>
<span class="sd">    :param result_filter:   `ResultFilter` instance</span>

<span class="sd">    .. versionadded:: 9.4</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SearchParameters.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.SearchParameters.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">search_filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">search_filter</span> <span class="o">=</span> <span class="n">SearchFilter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result_filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result_filter</span> <span class="o">=</span> <span class="n">ResultFilter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SearchFilter</span> <span class="o">=</span> <span class="n">search_filter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResultFilter</span> <span class="o">=</span> <span class="n">result_filter</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SearchFilter: </span><span class="si">%s</span><span class="s1">, ResultFilter: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SearchFilter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ResultFilter</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SearchParameters(search_filter=</span><span class="si">%r</span><span class="s1">,result_filter=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SearchFilter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ResultFilter</span><span class="p">)</span></div>

<div class="viewcode-block" id="DapClient"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient">[docs]</a><span class="k">class</span> <span class="nc">DapClient</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DapClient class to communicate with a Geosoft DAP server.</span>

<span class="sd">    :param url:         url of the server, default is &#39;http://dap.geosoft.com/&#39;</span>
<span class="sd">    :param get_catalog: `True` to get the server catalog.  If `False` (the default) call method `catalog()`</span>
<span class="sd">                        to get the retrieve the catalog from the server. The catalog is cached as</span>
<span class="sd">                        part of the instance.</span>

<span class="sd">    .. versionadded:: 9.4</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xtype</span><span class="p">,</span> <span class="n">xvalue</span><span class="p">,</span> <span class="n">xtraceback</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">_t</span><span class="p">(</span><span class="s1">&#39;unknown name&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">datasets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">datasets</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> datasets)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>

<div class="viewcode-block" id="DapClient.__init__"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://dap.geosoft.com/&#39;</span><span class="p">,</span> <span class="n">get_catalog</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_http_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_http_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;test&#39;</span><span class="p">}</span>

        <span class="c1"># establish url and rest url</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;rest/&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rest_url</span> <span class="o">=</span> <span class="n">url</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="n">url</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rest_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;rest/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="n">url</span>

        <span class="c1"># configuration</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span>
        <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DapClientException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Server </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> has a problem:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))))</span>

        <span class="c1"># dataset catalog</span>
        <span class="k">if</span> <span class="n">get_catalog</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DapClientException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Server </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> has a problem:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_next</span> <span class="o">=</span> <span class="mi">0</span></div>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_next</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">ds</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>

        <span class="n">card</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;catalog index </span><span class="si">{}</span><span class="s1"> out of range </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">)))</span>
            <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">hierarchy</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hierarchy</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hierarchy</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">Hierarchy</span> <span class="o">!=</span> <span class="n">hierarchy</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">Title</span> <span class="o">==</span> <span class="n">title</span><span class="p">:</span>
                    <span class="n">card</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="n">card</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">card</span><span class="o">.</span><span class="n">dap_client</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">card</span><span class="o">.</span><span class="n">dap_client</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">return</span> <span class="n">card</span>

        <span class="k">raise</span> <span class="n">DapClientException</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> not found in catalog&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_http_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">decoder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw_content</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rest_url</span> <span class="o">+</span> <span class="n">url</span><span class="p">,</span>
                       <span class="n">params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_params</span><span class="p">,</span>
                       <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">raw_content</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">gxu</span><span class="o">.</span><span class="n">dict_from_http_response_text</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_http_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">post_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decoder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">post_parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">post_parameters</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">post_parameters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_json_default</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rest_url</span> <span class="o">+</span> <span class="n">url</span><span class="p">,</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">post_parameters</span><span class="p">,</span>
                        <span class="n">params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_params</span><span class="p">,</span>
                        <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_headers</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">decoder</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

<div class="viewcode-block" id="DapClient.datacard_from_id"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.datacard_from_id">[docs]</a>    <span class="k">def</span> <span class="nf">datacard_from_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `DataCard` instance based on the dataset ID #</span>

<span class="sd">        :param id: dataset id</span>
<span class="sd">        :return: `DataCard` instance</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">card</span>

        <span class="k">raise</span> <span class="n">DapClientException</span><span class="p">(</span><span class="s1">&#39;Id </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> not found in catalog&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span></div>


<div class="viewcode-block" id="DapClient.get"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        GET information from the server.</span>

<span class="sd">        :param what:    string of what to get. for example &quot;dataset/properties/265&quot; retrieves</span>
<span class="sd">                        the dataset properties for dataset 265.  See http://dap.geosoft.com/REST/dataset/help</span>
<span class="sd">                        for a list of the kinds of things you can get about a dataset.</span>

<span class="sd">        :return: requested info as a dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_get</span><span class="p">(</span><span class="n">what</span><span class="p">)</span></div>

<div class="viewcode-block" id="DapClient.post"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.post">[docs]</a>    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        POST information from the server.</span>

<span class="sd">        :param what:    string of what to post.</span>

<span class="sd">        :return: returned info as a dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_post</span><span class="p">(</span><span class="n">what</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Server url.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return service configuration info.</span>

<span class="sd">        See http://dap.geosoft.com/REST/service/help/operations/GetConfiguration</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_get</span><span class="p">(</span><span class="s1">&#39;service/configuration&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>

<div class="viewcode-block" id="DapClient.catalog"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.catalog">[docs]</a>    <span class="k">def</span> <span class="nf">catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a filtered catalog list.</span>

<span class="sd">        :param search_parameters:   search filter, instance of `SearchParameters`</span>
<span class="sd">        :param refresh:             `True` to force a refresh, otherwise cached catalog is returned</span>
<span class="sd">        :return:                    list of server catalog entries as `DataCard` instances</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">search_parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">search_parameters</span> <span class="o">=</span> <span class="n">SearchParameters</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">refresh</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_post</span><span class="p">(</span><span class="s1">&#39;catalog/search&#39;</span><span class="p">,</span> <span class="n">search_parameters</span><span class="p">,</span> <span class="n">decoder</span><span class="o">=</span><span class="n">_decode_object</span><span class="p">)</span>

        <span class="c1"># assign this server to all cards</span>
        <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span><span class="p">:</span>
            <span class="n">card</span><span class="o">.</span><span class="n">dap_client</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat</span></div>

<div class="viewcode-block" id="DapClient.fetch_data"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.fetch_data">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datacard</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">max_seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch data from the server.</span>

<span class="sd">        :param datacard:    `DataCard` instance, or a dataset description (hierarchy, title) or just title.</span>
<span class="sd">        :param filename:    file name in which to plase data, default is a temporary geosoft gris file.</span>
<span class="sd">        :param extent:      `geosoft.gxpy.geometry.Point2` instance, or a `BoundingBox` instance</span>
<span class="sd">        :param resolution:  data resolution in the length units of the extent coordinate system</span>
<span class="sd">        :param max_seconds: maximum number of seconds to wait for the process to finish</span>
<span class="sd">        :param progress:    callback that can report progress, for example `progress=print` will print to the console</span>
<span class="sd">        :param cadence:     time in seconds between checking on server preparation status.</span>
<span class="sd">        :return:            data file name, which may be a temporry file.  Temporary files will only persist</span>
<span class="sd">                            during the live of the current context.</span>

<span class="sd">        .. code::</span>

<span class="sd">            import geosoft.gxpy.gx as gx</span>
<span class="sd">            import geosoft.gxpy.dap_client as gxdap:</span>

<span class="sd">            gx.GXpy()</span>

<span class="sd">            with gxdap.DapClient() as dap:</span>

<span class="sd">                # some point data</span>
<span class="sd">                dataset = dap[&#39;Kimberlite Indicator Mineral Grain Chemistry&#39;]</span>
<span class="sd">                extent = gxgeo.Point2(((-112, 65), (-111, 65.5)), coordinate_system=&#39;NAD83&#39;)</span>
<span class="sd">                data_file = dap.fetch_data(dataset, extent=extent, resolution=0, progress=print)</span>

<span class="sd">        .. versionadded:: 9.4</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datacard</span><span class="p">,</span> <span class="n">DataCard</span><span class="p">):</span>
            <span class="n">datacard</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">datacard</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">gx</span><span class="p">()</span><span class="o">.</span><span class="n">temp_file</span><span class="p">(</span><span class="n">DataType</span><span class="o">.</span><span class="n">datatype_default_extension</span><span class="p">(</span><span class="n">datacard</span><span class="o">.</span><span class="n">Type</span><span class="p">))</span>
        <span class="n">folder</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;dataset/extract/resolution/&#39;</span> <span class="o">+</span> <span class="n">datacard</span><span class="o">.</span><span class="n">Id</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datacard</span><span class="o">.</span><span class="n">Extents</span><span class="p">)</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;Default&#39;</span><span class="p">]</span>

        <span class="n">pro</span> <span class="o">=</span> <span class="n">_t</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Fetching </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">(</span><span class="si">{}</span><span class="s1">) from </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> to file </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="n">datacard</span><span class="o">.</span><span class="n">Title</span><span class="p">,</span> <span class="n">datacard</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">gx</span><span class="o">.</span><span class="n">gx</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pro</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
            <span class="n">progress</span><span class="p">(</span><span class="n">pro</span><span class="p">)</span>

        <span class="n">extract_parameters</span> <span class="o">=</span> <span class="n">DataExtract</span><span class="p">(</span><span class="n">extents</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                         <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
                                         <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

        <span class="n">urlx</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">extract_url</span><span class="p">(</span><span class="n">datacard</span><span class="o">.</span><span class="n">Type</span><span class="p">)</span> <span class="o">+</span> <span class="n">datacard</span><span class="o">.</span><span class="n">Id</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_post</span><span class="p">(</span><span class="n">urlx</span><span class="p">,</span> <span class="n">extract_parameters</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># give it a second in case it is really fast</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;dataset/extract/progress/&#39;</span> <span class="o">+</span> <span class="n">key</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">stage</span> <span class="o">=</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;Stage&#39;</span><span class="p">]</span>
        <span class="n">seconds</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">stage</span> <span class="o">!=</span> <span class="n">ExtractProgressStatus</span><span class="o">.</span><span class="n">Complete</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span>
               <span class="n">stage</span> <span class="o">!=</span> <span class="n">ExtractProgressStatus</span><span class="o">.</span><span class="n">Cancelled</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span>
               <span class="n">seconds</span> <span class="o">&lt;</span> <span class="n">max_seconds</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="n">ExtractProgressStatus</span><span class="o">.</span><span class="n">Failed</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DapClientException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Extraction failed, likely no data in this extent:</span><span class="se">\n</span><span class="s1">url: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">extract detail:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span>
                                         <span class="nb">format</span><span class="p">(</span><span class="n">urlx</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">extract_parameters</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
                <span class="n">progress</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;PercentComplete&#39;</span><span class="p">]))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">cadence</span><span class="p">)</span>
            <span class="n">seconds</span> <span class="o">+=</span> <span class="n">cadence</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">stage</span> <span class="o">=</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;Stage&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="n">ExtractProgressStatus</span><span class="o">.</span><span class="n">Cancelled</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_get</span><span class="p">(</span><span class="s1">&#39;dataset/extract/describe/&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">zip_file</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">gx</span><span class="p">()</span><span class="o">.</span><span class="n">temp_file</span><span class="p">(</span><span class="s1">&#39;zip&#39;</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;stream/dataset/extract/block/&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">zip_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>  <span class="c1">## Open temporary file as bytes</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;NumberOfBlocks&#39;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
                    <span class="n">progress</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Download block </span><span class="si">{}</span><span class="s1"> of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span>
                             <span class="nb">format</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;NumberOfBlocks&#39;</span><span class="p">]))</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">raw_content</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="n">gxsys</span><span class="o">.</span><span class="n">unzip</span><span class="p">(</span><span class="n">zip_file</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="n">folder</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">zip_file</span><span class="p">)</span>
        <span class="n">return_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">return_file</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DapClientException</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;No result file, something went wrong.&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
            <span class="n">progress</span><span class="p">(</span><span class="n">_t</span><span class="p">(</span><span class="s1">&#39;Fetch complete: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">return_file</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">return_file</span></div>

<div class="viewcode-block" id="DapClient.fetch_image"><a class="viewcode-back" href="../../../geosoft.gxpy.dap_client.html#geosoft.gxpy.dap_client.DapClient.fetch_image">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datacard</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datacard</span><span class="p">,</span> <span class="n">DataCard</span><span class="p">):</span>
            <span class="n">datacard</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">datacard</span><span class="p">]</span>
            <span class="k">pass</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Geosoft GX Python API 9.10.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geosoft.gxpy.dap_client</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Geosoft Inc.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>